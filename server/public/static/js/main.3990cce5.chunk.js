(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,n){e.exports=n(224)},198:function(e,t,n){},200:function(e,t,n){},224:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(104),i=n.n(o),c=(n(196),n(198),n(4)),s=n(5),l=n(7),d=n(6),u=n(8),m=n(229),p=n(228),h=(n(200),n(26)),f=n(225),g=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).handleLogout=function(e){n.props.logout()},n.state={loggedInUser:null},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(h.a)({},this.state,{loggedInUser:e.userInSession}))}},{key:"render",value:function(){return this.state.loggedInUser?r.a.createElement("nav",{className:"nav-style box"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{onClick:this.handleLogout},"Logout")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/profile"},this.state.loggedInUser.username)))):r.a.createElement("nav",{className:"navbar nav-style box",role:"navigation","aria-label":"main navigation"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(f.a,{to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/signup"},"Signup")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/login"},"Login"))))}}]),t}(a.Component),v=n(13),S=n.n(v);n(22).config();var w=function e(){var t=this;Object(c.a)(this,e),this.signup=function(e,n){return t.service.post("/signup",{username:e,password:n}).then(function(e){return e.data})},this.login=function(e,n){return t.service.post("/login",{username:e,password:n}).then(function(e){return e.data})},this.loggedin=function(){return t.service.get("/currentuser").then(function(e){return e.data}).catch(function(e){console.error("Error in getUser",e)})},this.logout=function(){return console.log("TRYING LOGOUT AT FRONT"),t.service.get("/logout").then(function(e){return e.data})},this.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api/auth"),withCredentials:!0})},E=n(34),b=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=n.state.username,a=n.state.password;n.service.signup(t,a).then(function(e){n.setState({username:"",password:""}),n.props.getUser(e.user)}).catch(function(e){return console.log(e)})},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(E.a)({},a,r))},n.state={username:"",password:""},n.service=new w,n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"card box"},r.a.createElement("h3",{class:"label is-medium"},"Welcome! create your account next:"),r.a.createElement("form",{onSubmit:this.handleFormSubmit},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Username:"),r.a.createElement("input",{className:"input",type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Password:"),r.a.createElement("input",{className:"input",type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("input",{className:"button is-primary is-rounded",type:"submit",value:"Sign up"})))}}]),t}(a.Component),C=n(227),O=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=n.state.username,a=n.state.password;n.service.login(t,a).then(function(e){n.setState({username:t,password:a,error:!1,redirect:!0}),n.props.getUser(e)}).catch(function(e){n.setState({username:t,password:a,error:!0})})},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(E.a)({},a,r))},n.state={username:"",password:"",redirect:!1},n.service=new w,n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(C.a,{to:"/"}):r.a.createElement("div",{className:"card box"},r.a.createElement("h3",{className:"label is-medium"},"Please, login"),r.a.createElement("form",{onSubmit:this.handleFormSubmit},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Username:"),r.a.createElement("input",{className:"input",type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Password:"),r.a.createElement("input",{className:"input",type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("input",{className:"button is-primary is-rounded",type:"submit",value:"Login"})),r.a.createElement("h1",null,this.state.error?"Error":""))}}]),t}(a.Component),y=n(2),j=n(2);j.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var n=function(e){t.deviceOrientation=e},a=function(){t.screenOrientation=window.orientation||0},r=function(){var e=new j.Vector3(0,0,1),t=new j.Euler,n=new j.Quaternion,a=new j.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(r,o,i,c,s){t.set(i,o,-c,"YXZ"),r.setFromEuler(t),r.multiply(a),r.multiply(n.setFromAxisAngle(e,-s))}}();this.connect=function(){a(),window.addEventListener("orientationchange",a,!1),window.addEventListener("deviceorientation",n,!1),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",a,!1),window.removeEventListener("deviceorientation",n,!1),t.enabled=!1},this.update=function(){var e;if(!1!==t.enabled){var n=t.deviceOrientation;if(e=window.screen.width<=740?0:90,n){var a=n.alpha?j.Math.degToRad(n.alpha)+t.alphaOffset:0,o=n.beta?j.Math.degToRad(n.beta+e):j.Math.degToRad(e),i=n.gamma?j.Math.degToRad(n.gamma):0,c=t.screenOrientation?j.Math.degToRad(t.screenOrientation):0;r(t.object.quaternion,a,o,i,c)}}},this.dispose=function(){t.disconnect()},this.connect()};var I=j.DeviceOrientationControls,D=n(2);D.CSS3DRenderer=function(){var e,t,n,a;console.log("THREE.CSS3DRenderer",D.REVISION);var r=new D.Matrix4,o={camera:{fov:0,style:""},objects:new WeakMap},i=document.createElement("div");i.style.overflow="hidden",this.domElement=i;var c=document.createElement("div");c.style.WebkitTransformStyle="preserve-3d",c.style.transformStyle="preserve-3d",i.appendChild(c);var s=/Trident/i.test(navigator.userAgent);function l(e){return Math.abs(e)<1e-10?0:e}function d(e){var t=e.elements;return"matrix3d("+l(t[0])+","+l(-t[1])+","+l(t[2])+","+l(t[3])+","+l(t[4])+","+l(-t[5])+","+l(t[6])+","+l(t[7])+","+l(t[8])+","+l(-t[9])+","+l(t[10])+","+l(t[11])+","+l(t[12])+","+l(-t[13])+","+l(t[14])+","+l(t[15])+")"}function u(e,t){var r=e.elements,o="matrix3d("+l(r[0])+","+l(r[1])+","+l(r[2])+","+l(r[3])+","+l(-r[4])+","+l(-r[5])+","+l(-r[6])+","+l(-r[7])+","+l(r[8])+","+l(r[9])+","+l(r[10])+","+l(r[11])+","+l(r[12])+","+l(r[13])+","+l(r[14])+","+l(r[15])+")";return s?"translate(-50%,-50%)translate("+n+"px,"+a+"px)"+t+o:"translate(-50%,-50%)"+o}this.getSize=function(){return{width:e,height:t}},this.setSize=function(r,o){n=(e=r)/2,a=(t=o)/2,i.style.width=r+"px",i.style.height=o+"px",c.style.width=r+"px",c.style.height=o+"px"};var m=function(){var e=new D.Vector3,t=new D.Vector3;return function(n,a){return e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(a.matrixWorld),e.distanceToSquared(t)}}();function p(e){for(var t=function(e){var t=[];return e.traverse(function(e){e instanceof D.CSS3DObject&&t.push(e)}),t}(e).sort(function(e,t){return o.objects.get(e).distanceToCameraSquared-o.objects.get(t).distanceToCameraSquared}),n=t.length,a=0,r=t.length;a<r;a++)t[a].element.style.zIndex=n-a}this.render=function(e,t){var l=t.projectionMatrix.elements[5]*a;o.camera.fov!==l&&(t.isPerspectiveCamera&&(i.style.WebkitPerspective=l+"px",i.style.perspective=l+"px"),o.camera.fov=l),e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld();var h=t.isOrthographicCamera?"scale("+l+")"+d(t.matrixWorldInverse):"translateZ("+l+"px)"+d(t.matrixWorldInverse),f=h+"translate("+n+"px,"+a+"px)";o.camera.style===f||s||(c.style.WebkitTransform=f,c.style.transform=f,o.camera.style=f),function e(t,n,a){if(t instanceof D.CSS3DObject){var i;t instanceof D.CSS3DSprite?(r.copy(n.matrixWorldInverse),r.transpose(),r.copyPosition(t.matrixWorld),r.scale(t.scale),r.elements[3]=0,r.elements[7]=0,r.elements[11]=0,r.elements[15]=1,i=u(r,a)):i=u(t.matrixWorld,a);var l=t.element,d=o.objects.get(t);if(void 0===d||d!==i){l.style.WebkitTransform=i,l.style.transform=i;var p={style:i};s&&(p.distanceToCameraSquared=m(n,t)),o.objects.set(t,p)}l.parentNode!==c&&c.appendChild(l)}for(var h=0,f=t.children.length;h<f;h++)e(t.children[h],n,a)}(e,t,h),s&&p(e)}};var M=D.CSS3DRenderer,N=n(2);(N=n(2)).CSS3DObject=function(e){N.Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},N.CSS3DObject.prototype=Object.create(N.Object3D.prototype),N.CSS3DObject.prototype.constructor=N.CSS3DObject,N.CSS3DSprite=function(e){N.CSS3DObject.call(this,e)},N.CSS3DSprite.prototype=Object.create(N.CSS3DObject.prototype),N.CSS3DSprite.prototype.constructor=N.CSS3DSprite;var x=function(e,t,n,a,r){var o=document.createElement("div");o.style.width="".concat(200,"px"),o.style.backgroundColor="#000";var i=document.createElement("iframe");i.style.border="0px";var c=["https://www.youtube.com/embed/",e,"?rel=0"].join("");i.src=c,o.appendChild(i);var s=new N.CSS3DObject(o);return s.position.set(t,n,a),s.rotation.y=r,console.log(e),console.log(c),s},R=function(e,t,n,a,r){var o=document.createElement("div");o.style.backgroundColor="#000";var i=document.createElement("img");i.style.border="0px",i.src=e,i.style.width="".concat(200,"px"),i.style.height="auto",o.appendChild(i);var c=new N.CSS3DObject(o);return c.position.set(t,n,a),c.rotation.y=r,console.log(e),c},U=function(e,t){var n,a,r=e-50,o=t.length,i=2*Math.PI/o,c=new N.Group;return t.forEach(function(e,t){var o=i*t;n=r*Math.cos(o),a=r*Math.sin(o);var s=3*Math.PI/2-o;if("IMAGE"==e.type){var l=new R(e.url,n,0,a,s);c.add(l)}else if("YOUTUBE"==e.type){var d=new x(e.url,n,0,a,s);c.add(d)}else{var u=new x(e,n,0,a,s);c.add(u)}}),c};n(22).config();var W=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).getImage=function(e){return n.service.get("/spaces/".concat(e)).then(function(e){console.log("Image from DB "+e.data),n.setState({image:e.data.image,media:e.data.media})}).catch(function(e){return console.log(e)})},n.init=function(e){var t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS;n.setState({controls:new I(t)}),t.position.set(0,0,-1e-4),r.domElement.className="scope",i.domElement.className="scopeCSS";var c=new y.SphereBufferGeometry(n.state.spaceRadius,60,40);c.scale(-1,1,1);var s=new y.TextureLoader;s.crossOrigin="";var l=s.load(n.state.image),d=new y.MeshBasicMaterial({map:l}),u=new y.Mesh(c,d);a.add(u);var m=new y.BoxBufferGeometry(100,100,100,4,4,4),p=new y.MeshBasicMaterial({color:16711935,wireframe:!0});new y.Mesh(m,p);console.log("MEDIA FROM THIS SPACE DB"),console.log(n.state.media);var h=U(n.state.spaceRadius,n.state.media);o.add(h);var f=document.getElementById("scopediv");r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),f.appendChild(r.domElement),i.setSize(window.innerWidth,window.innerHeight),f.appendChild(i.domElement),window.addEventListener("resize",n.onWindowResize,!1)},n.animate=function(){var e=n.state,t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS,c=e.controls;window.requestAnimationFrame(n.animate),c.update(),r.render(a,t),i.render(o,t)},n.onWindowResize=function(){var e=n.state,t=e.camera,a=e.renderer,r=e.rendererCSS;t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight),r.setSize(window.innerWidth,window.innerHeight)},n.componentDidMount=function(){var e=n.state.id;n.getImage(e).then(function(){n.init(n.state),n.animate()})},n.componentDidUpdate=function(e){if(n.props.id!==e.id){var t=n.props.id;n.setState({id:t}),n.getImage(t).then(function(){n.init(n.state),n.animate()})}},n.state={spaceRadius:500,camera:new y.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),scene:new y.Scene,sceneCSS:new y.Scene,renderer:new y.WebGLRenderer({antialias:!0}),rendererCSS:new M,id:n.props.id},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"scopediv"})}}]),t}(r.a.Component),P=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"ScopeView"},r.a.createElement(W,{id:this.props.id}))}}]),t}(a.Component),T=function(){return new Promise(function(e,t){navigator.geolocation||t("No geolocation available"),navigator.geolocation.getCurrentPosition(function(t){var n={lat:t.coords.latitude,lng:t.coords.longitude};e(n)},t)})};n(22).config();var k=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).createSpace=function(e,t){t.lat,t.lng;console.log(t);var a={image:e,creator:n.state.loggedInUser._id,location:t};return n.service.post("/spaces",a).then(function(e){console.log("CREATED NEW SPACE:"),console.log(e.data),n.sendNewSpace(e.data),n.addSpaceToUser(e.data)}).catch(function(e){return console.log(e)})},n.sendNewSpace=function(e){n.props.newSpace(e._id,e.location)},n.addSpaceToUser=function(e){var t=n.state.loggedInUser;console.log("ADD TO USER CATALOG"),console.log(e),console.log(t),n.updateCatalog(t.catalog,e._id)},n.updateCatalog=function(e,t){var a={spaceId:t};return n.service.patch("/catalog/".concat(e),a).then(function(e){console.log("Catalog updated on DB "+e.data)}).catch(function(e){return console.log(e)})},n.state={loggedInUser:n.props.userInSession},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleChange",value:function(e){this.setState({file:e.target.files[0]})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.uploadImage(this.state.file).then(function(){console.log("uploaded image to create space"),console.log(t.state.img_url),T().then(function(e){console.log(e),t.createSpace(t.state.img_url,e)})})}},{key:"uploadImage",value:function(e){var t=this,n=new FormData;return n.append("photo",e),this.service.post("/uploadCloud",n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.setState({img_url:e.data.secure_url})}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"file"},r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("label",{className:"file-label"},r.a.createElement("input",{className:"file-input",type:"file",onChange:function(t){return e.handleChange(t)}}),r.a.createElement("span",{className:"file-cta"},r.a.createElement("span",{className:"file-label"},"Choose a panorama"))),r.a.createElement("button",{className:"button is-primary",type:"submit"},"Upload a panorama of your space"))))}}]),t}(r.a.Component);n(22).config();var A=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).createMedia=function(e){var t={url:e,type:"IMAGE"};return n.service.post("/media",t).then(function(e){console.log("CREATED NEW IMAGE:"),console.log(e.data),n.addMediaToSpace(e.data)}).catch(function(e){return console.log(e)})},n.addMediaToSpace=function(e){var t=n.state.spaceID;console.log("SPACE ID UPLOAD IMG "+t),n.updateSpace(e,t)},n.updateSpace=function(e,t){var a=e;return n.service.patch("/spaces/".concat(t),a).then(function(e){console.log("Space updated on DB "+e.data)}).catch(function(e){return console.log(e)})},n.state={loggedInUser:n.props.userInSession,spaceID:n.props.currentSpace},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleChange",value:function(e){this.setState({file:e.target.files[0]})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.uploadImage(this.state.file).then(function(){console.log("uploaded image to this space"),console.log(t.state.img_url),t.createMedia(t.state.img_url)})}},{key:"uploadImage",value:function(e){var t=this,n=new FormData;return n.append("photo",e),this.service.post("/uploadCloud",n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.setState({img_url:e.data.secure_url})}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this;return console.log("SPACE ID UPLOAD IMG "+this.state.spaceID),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("input",{type:"file",onChange:function(t){return e.handleChange(t)}})," ",r.a.createElement("br",null),r.a.createElement("span",{className:"file-cta"},r.a.createElement("span",{className:"file-label"},"Choose an image")),r.a.createElement("button",{type:"submit",isColor:"primary"},"Upload Images to this Scope"))))}}]),t}(r.a.Component),L=n(2);(L=n(2)).CSS3DObject=function(e){L.Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},L.CSS3DObject.prototype=Object.create(L.Object3D.prototype),L.CSS3DObject.prototype.constructor=L.CSS3DObject,L.CSS3DSprite=function(e){L.CSS3DObject.call(this,e)},L.CSS3DSprite.prototype=Object.create(L.CSS3DObject.prototype),L.CSS3DSprite.prototype.constructor=L.CSS3DSprite;var B=function(e,t,n,a,r){var o=document.createElement("div");o.style.width="".concat(200,"px"),o.style.backgroundColor="#000";var i=document.createElement("iframe");i.style.border="0px";var c=["https://www.youtube.com/embed/",e,"?rel=0"].join("");i.src=c,o.appendChild(i);var s=new L.CSS3DObject(o);return s.position.set(t,n,a),s.rotation.y=r,s},z=function(e,t,n,a,r){var o=document.createElement("div");o.style.backgroundColor="#000";var i=document.createElement("img");i.style.border="0px",i.src=e,i.style.width="".concat(200,"px"),i.style.height="auto",o.appendChild(i);var c=new L.CSS3DObject(o);return c.position.set(t,n,a),c.rotation.y=r,c},H=function(e,t){console.log("MEDIA SEND TO CSS ELEMENTS"),console.log(t);var n,a,r=e-50,o=t.length,i=2*Math.PI/o,c=new L.Group;return t.forEach(function(e,t){var o=i*t;n=r*Math.cos(o),a=r*Math.sin(o);var s=3*Math.PI/2-o;if("IMAGE"==e.type){var l=new z(e.url,n,0,a,s);c.add(l)}else if("YOUTUBE"==e.type){var d=new B(e.url,n,0,a,s);c.add(d)}else{console.log(e);var u=new B(e,n,0,a,s);c.add(u)}}),c},G=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(d.a)(t).call(this))).cameraStart=function(){var t=document.querySelector("#camera--view");navigator.mediaDevices.getUserMedia(e.state.constraints).then(function(e){e.getTracks()[0];t.srcObject=e}).catch(function(e){console.error("Oops. Something is broken.",e)})},e.state={cameraView:document.querySelector("#camera--view"),constraints:{video:{facingMode:"environment"},audio:!1}},window.addEventListener("load",e.cameraStart,!1),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("video",{className:"camera",id:"camera--view",autoPlay:!0,playsInline:!0})}}]),t}(r.a.Component);n(22).config();var F=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).getImage=function(e){return n.service.get("/spaces/".concat(e)).then(function(e){n.setState({image:e.data.image,media:e.data.media}),console.log("Image from DB "+e.data.image)}).catch(function(e){return console.log(e)})},n.init=function(e){var t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS;n.setState({controls:new I(t)}),t.position.set(0,0,-1e-4),r.domElement.className="scopehidden",i.domElement.className="scopeCSS";var c=new y.SphereBufferGeometry(n.state.spaceRadius,60,40);c.scale(-1,1,1);var s=new y.TextureLoader;s.crossOrigin="";var l=s.load(n.state.image),d=new y.MeshBasicMaterial({map:l}),u=new y.Mesh(c,d);a.add(u);var m,p=new y.BoxBufferGeometry(100,100,100,4,4,4),h=new y.MeshBasicMaterial({color:16711935,wireframe:!0}),f=(new y.Mesh(p,h),n.state.media);console.log("MEDIA FROM THIS SPACE DB"),console.log(f),void 0!=f&&(m=H(n.state.spaceRadius,f),console.log(m),o.add(m));var g=document.getElementById("scopecamdiv");r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(r.domElement),g.appendChild(r.domElement),i.setSize(window.innerWidth,window.innerHeight),g.appendChild(i.domElement),window.addEventListener("resize",n.onWindowResize,!1)},n.animate=function(){var e=n.state,t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS,c=e.controls;window.requestAnimationFrame(n.animate),c.update(),r.render(a,t),i.render(o,t)},n.onWindowResize=function(){var e=n.state,t=e.camera,a=e.renderer,r=e.rendererCSS;t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight),r.setSize(window.innerWidth,window.innerHeight)},n.componentDidMount=function(){var e=n.state.id;n.getImage(e).then(function(){n.init(n.state),n.animate()})},n.componentDidUpdate=function(e){if(n.props.id!==e.id){var t=n.props.id;n.setState({id:t}),n.getImage(t).then(function(){n.init(n.state),n.animate()})}},n.state={spaceRadius:500,camera:new y.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),scene:new y.Scene,sceneCSS:new y.Scene,renderer:new y.WebGLRenderer({antialias:!0}),rendererCSS:new M,id:n.props.id},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"scopecamdiv"},r.a.createElement(G,null))}}]),t}(r.a.Component);n(22).config();var _=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).getImage=function(e){var t=[];return n.service.get("/spaces/".concat(e)).then(function(e){n.setState({image:e.data.image,mediaIDs:e.data.media}),n.sendNewSpace(e.data),console.log("Image from DB "+e.data.image)}).then(function(){return n.state.mediaIDs.forEach(function(e){"object"==typeof e&&(e=e._id),t.push(n.service.get("/media/".concat(e)))}),Promise.all(t)}).then(function(e){var t=[];e.forEach(function(e){t.push(e.data)}),n.setState({media:t}),console.log("MEDIA OBJECTS IN STATE"),console.log(n.state.media)}).catch(function(e){return console.log(e)})},n.sendNewSpace=function(e){n.props.newSpace(e._id,e.location)},n.init=function(e){var t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS;n.setState({controls:new I(t)}),t.position.set(0,0,-1e-4),r.domElement.className="scopehidden",i.domElement.className="scopeCSS";var c=new y.SphereBufferGeometry(n.state.spaceRadius,60,40);c.scale(-1,1,1);var s=new y.TextureLoader;s.crossOrigin="";var l=s.load(n.state.image),d=new y.MeshBasicMaterial({map:l}),u=new y.Mesh(c,d);a.add(u);var m,p=n.state.media;console.log("MEDIA FROM THIS SPACE DB"),console.log(p),void 0!==p&&(m=H(n.state.spaceRadius,p),console.log(m),o.add(m));var h=document.getElementById("scopecamdiv");r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(r.domElement),h.appendChild(r.domElement),i.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(i.domElement),h.appendChild(i.domElement),window.addEventListener("resize",n.onWindowResize,!1)},n.animate=function(){var e=n.state,t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS,c=e.controls;window.requestAnimationFrame(n.animate),c.update(),r.render(a,t),i.render(o,t)},n.onWindowResize=function(){var e=n.state,t=e.camera,a=e.renderer,r=e.rendererCSS;t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight),r.setSize(window.innerWidth,window.innerHeight)},n.componentDidMount=function(){var e=n.props.match.params.id;console.log("COMPONENT CAMERA SCOPE ID"),console.log(e),n.setState({id:e}),n.getImage(e).then(function(){n.init(n.state),n.animate()})},n.state={spaceRadius:500,camera:new y.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),scene:new y.Scene,sceneCSS:new y.Scene,renderer:new y.WebGLRenderer({antialias:!0}),rendererCSS:new M},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.match.params.id;return console.log("id a route scope "+e),r.a.createElement("div",{id:"scopecamdiv"},r.a.createElement("span",{className:"switch-button-container"},r.a.createElement("button",{className:"button is-primary is-rounded switch-button"},r.a.createElement(f.a,{to:"/scope/".concat(e)},"VR"))),r.a.createElement(G,null))}}]),t}(r.a.Component);n(22).config();var q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){console.log(e);var t=e.target.value;n.setState({youtubeID:t})},n.createMedia=function(e){var t={url:e,type:"YOUTUBE"};return n.service.post("/media",t).then(function(e){console.log("CREATED NEW YOUTUBE VIDEO:"),console.log(e.data),n.addMediaToSpace(e.data)}).catch(function(e){return console.log(e)})},n.addMediaToSpace=function(e){var t=n.state.spaceID;n.updateSpace(e,t)},n.updateSpace=function(e,t){var a=e;return n.service.patch("/spaces/".concat(t),a).then(function(e){console.log("Space updated on DB "+e.data)}).catch(function(e){return console.log(e)})},n.state={loggedInUser:n.props.userInSession,spaceID:n.props.currentSpace,youtubeID:""},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),console.log("uploaded youtube video to this space"),console.log(this.state.img_url),this.createMedia(this.state.youtubeID)}},{key:"render",value:function(){var e=this;return console.log("SPACE ID UPLOAD VIDEO "+this.state.spaceID),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("input",{type:"text",name:"youtubeID",onChange:function(t){return e.handleChange(t)},placeholder:"VVsCOnWGHh8"}),r.a.createElement("button",{type:"submit"},"Upload Media")))}}]),t}(r.a.Component),V=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={loggedInUser:null},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(h.a)({},this.state,{loggedInUser:e.userInSession}))}},{key:"render",value:function(){return r.a.createElement("nav",{className:"nav-style box",id:"bottom-nav"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(f.a,{to:"/upload-media-img"},"+Image")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/upload-scope/"},"New")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/upload-media-video"},"+Video"))))}}]),t}(a.Component);n(103);n(22).config();var Y=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).getScopes=function(){var e=n.props.userInSession.catalog,t=[];return n.setState({catalogId:e}),n.service.get("/catalog/".concat(e)).then(function(e){return e.data.spaces.forEach(function(e){t.push(n.service.get("/spaces/".concat(e)))}),Promise.all(t)}).then(function(e){var t=[];e.forEach(function(e){t.push(e.data)}),n.setState({userSpaces:t})}).catch(function(e){return console.log(e)})},n.state={loggedInUser:e.userInSession},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n.getScopes(),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(h.a)({},this.state,{loggedInUser:e.userInSession}))}},{key:"render",value:function(){if(this.props.userInSession){var e=this.state.userSpaces;return e?(e.forEach(function(e){}),r.a.createElement("div",null,r.a.createElement("h1",{className:"profile-feed"},"Profile"),e.map(function(e){return r.a.createElement("div",{key:e._id,className:"scope-in-feed"},r.a.createElement(f.a,{to:"/scope/".concat(e._id)},r.a.createElement("img",{className:"panorama-feed",height:"50px",src:e.image})))}))):r.a.createElement("div",{className:"profile-feed"},r.a.createElement("h1",null,"Profile"))}return r.a.createElement("div",null)}}]),t}(a.Component);n(22).config();var J=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).getScopes=function(){var e=n.props.match.params.username,t=[];n.service.get("auth/user/".concat(e)).then(function(e){var t=e.data.catalog;return console.log("USER FROM DB TO PROFILE"),console.log(e),n.setState({catalogId:t}),n.service.get("/catalog/".concat(t))}).then(function(e){return e.data.spaces.forEach(function(e){t.push(n.service.get("/spaces/".concat(e)))}),Promise.all(t)}).then(function(e){var t=[];e.forEach(function(e){t.push(e.data)}),n.setState({userSpaces:t})}).catch(function(e){return console.log(e)})},n.state={},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(h.a)({},this.state,{loggedInUser:e.userInSession})),this.getScopes()}},{key:"render",value:function(){var e=this.state.userSpaces;return e?(e.forEach(function(e){}),r.a.createElement("div",null,r.a.createElement("h1",{className:"profile-feed"},"Profile"),e.map(function(e){return r.a.createElement("div",{key:e._id,className:"scope-in-feed"},r.a.createElement(f.a,{to:"/scope/".concat(e._id)},r.a.createElement("img",{className:"panorama-feed",height:"50px",src:e.image})))}))):r.a.createElement("div",{className:"profile-feed"},r.a.createElement("h1",null,"Profile"))}}]),t}(a.Component);n(22).config();var Z=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).getImage=function(e){var t=[];return n.service.get("/spaces/".concat(e)).then(function(e){n.setState({image:e.data.image,mediaIDs:e.data.media}),n.sendNewSpace(e.data),console.log("Image from DB "+e.data.image)}).then(function(){return n.state.mediaIDs.forEach(function(e){"object"==typeof e&&(e=e._id),t.push(n.service.get("/media/".concat(e)))}),Promise.all(t)}).then(function(e){var t=[];e.forEach(function(e){t.push(e.data)}),n.setState({media:t}),console.log("MEDIA OBJECTS IN STATE"),console.log(n.state.media)}).catch(function(e){return console.log(e)})},n.sendNewSpace=function(e){n.props.newSpace(e._id,e.location)},n.init=function(e){var t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS;n.setState({controls:new I(t)}),t.position.set(0,0,-.001),r.domElement.className="scope",i.domElement.className="scopeCSS";var c=new y.SphereBufferGeometry(n.state.spaceRadius,60,40);c.scale(-1,1,1);var s=new y.TextureLoader;s.crossOrigin="";var l=s.load(n.state.image),d=new y.MeshBasicMaterial({map:l}),u=new y.Mesh(c,d);a.add(u);var m,p=n.state.media;console.log("MEDIA FROM THIS SPACE DB"),console.log(p),void 0!==p&&(m=H(n.state.spaceRadius,p),console.log(m),o.add(m));var h=document.getElementById("scopediv");r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),h.appendChild(r.domElement),i.setSize(window.innerWidth,window.innerHeight),h.appendChild(i.domElement),window.addEventListener("resize",n.onWindowResize,!1)},n.animate=function(){var e=n.state,t=e.camera,a=e.scene,r=e.renderer,o=e.sceneCSS,i=e.rendererCSS,c=e.controls;window.requestAnimationFrame(n.animate),c.update(),r.render(a,t),i.render(o,t)},n.onWindowResize=function(){var e=n.state,t=e.camera,a=e.renderer,r=e.rendererCSS;t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight),r.setSize(window.innerWidth,window.innerHeight)},n.componentDidMount=function(){var e=n.props.match.params.id;n.getImage(e).then(function(){n.init(n.state),n.animate()})},n.state={spaceRadius:500,camera:new y.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),scene:new y.Scene,sceneCSS:new y.Scene,renderer:new y.WebGLRenderer({antialias:!0}),rendererCSS:new M},n.service=S.a.create({baseURL:"".concat("https://in-situ.herokuapp.com","/api")}),console.log("COMPONENT SCOPE ID"),console.log(n.props),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.match.params.id;return console.log("id a route camera "+e),r.a.createElement("div",{id:"scopediv"},r.a.createElement("span",{className:"switch-button-container"},r.a.createElement("button",{className:"button is-primary is-rounded switch-button"},r.a.createElement(f.a,{to:"/camera/".concat(e)},"AR"))))}}]),t}(r.a.Component),Q=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(d.a)(t).call(this))).getTheUser=function(t){e.setState({loggedInUser:t})},e.logout=function(){e.service.logout().then(function(){e.setState({loggedInUser:null})})},e.actualizeSpace=function(t,n){e.setState({spaceId:t,spaceLocation:n})},e.state={loggedInUser:null,spaceId:"5bc3313fdd315804e045a573",spaceLocation:{lat:40.3923451,lng:-3.6985332999999994}},e.service=new w,e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"fetchUser",value:function(){var e=this;null===this.state.loggedInUser&&this.service.loggedin().then(function(t){e.setState({loggedInUser:t})}).catch(function(t){e.setState({loggedInUser:!1})})}},{key:"render",value:function(){var e=this;return console.log("SPACE ID STATE!!!!!!!!"),console.log(this.state.spaceId),this.fetchUser(),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"header"},r.a.createElement(g,{userInSession:this.state.loggedInUser,logout:this.logout})),r.a.createElement("main",null,r.a.createElement(m.a,null,r.a.createElement(p.a,{exact:!0,path:"/signup",render:function(){return r.a.createElement(b,{getUser:e.getTheUser})}}),r.a.createElement(p.a,{exact:!0,path:"/login",render:function(){return r.a.createElement(O,{getUser:e.getTheUser})}}),r.a.createElement(p.a,{path:"/profile/:username",render:function(e){return r.a.createElement(J,e)}}),r.a.createElement(p.a,{exact:!0,path:"/profile",render:function(){return r.a.createElement(Y,{userInSession:e.state.loggedInUser})}}),r.a.createElement(p.a,{path:"/scope/:id",render:function(t){return r.a.createElement(Z,Object.assign({newSpace:function(t,n){e.actualizeSpace(t,n)}},t))},newSpace:function(t,n){e.actualizeSpace(t,n)}}),r.a.createElement(p.a,{exact:!0,path:"/scope",render:function(){return r.a.createElement(P,{id:e.state.spaceId})}}),r.a.createElement(p.a,{exact:!0,path:"/camera/:id",render:function(t){return r.a.createElement(_,Object.assign({newSpace:function(t,n){e.actualizeSpace(t,n)}},t))}}),r.a.createElement(p.a,{exact:!0,path:"/camera",render:function(){return r.a.createElement(F,{id:e.state.spaceId})}}),r.a.createElement(p.a,{exact:!0,path:"/upload-scope",render:function(){return r.a.createElement(k,{newSpace:function(t,n){e.actualizeSpace(t,n)},userInSession:e.state.loggedInUser})}}),r.a.createElement(p.a,{exact:!0,path:"/upload-media-img",render:function(){return r.a.createElement(A,{userInSession:e.state.loggedInUser,currentSpace:e.state.spaceId})}}),r.a.createElement(p.a,{exact:!0,path:"/upload-media-video",render:function(){return r.a.createElement(q,{userInSession:e.state.loggedInUser,currentSpace:e.state.spaceId})}}))),r.a.createElement("footer",null,r.a.createElement(V,{userInSession:this.state.loggedInUser})))}}]),t}(a.Component),X=n(226);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(X.a,null,r.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[105,2,1]]]);
//# sourceMappingURL=main.3990cce5.chunk.js.map