{"version":3,"sources":["scope white.png","components/maps/constants.js","components/Navbar.js","components/auth/AuthService.js","components/auth/Signup.js","components/auth/Login.js","lib/DeviceOrientationControls.js","lib/CSS3DRenderer.js","components/3dSpace/CSS3elementsPREV.js","components/3dSpace/Scope.js","components/maps/geolocalize.js","components/ScopeView.js","components/upload/UploadSpace.js","components/upload/UploadMediaImg.js","components/3dSpace/CSS3elements.js","components/Camera.js","components/3dSpace/ScopeCamera.js","components/3dSpace/ScopeCameraID.js","components/upload/UploadMediaVideo.js","components/upload/UploadMediaText.js","components/BottomMenu.js","components/Profile.js","components/ProfileID.js","lib/TrackballControls.js","components/3dSpace/ScopeID.js","components/3dSpace/Welcome.js","components/Feed.js","components/maps/Map.js","components/ExploreMap.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","COORDINATES","lat","lng","API_CONFIG","key","language","resetMarkerAnimation","marker","window","setTimeout","setAnimation","STYLES","featureType","elementType","stylers","color","gamma","lightness","saturation","weight","visibility","Navbar","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleLogout","e","logout","state","loggedInUser","nextProps","setState","objectSpread","page","console","log","react_default","a","createElement","className","id","Link","to","onClick","username","src","role","aria-label","Component","require","config","AuthService","signup","password","service","post","then","response","data","login","loggedin","get","catch","err","error","axios","create","baseURL","concat","process","withCredentials","Signup","handleFormSubmit","event","preventDefault","redirect","getUser","user","handleChange","_event$target","target","name","value","defineProperty","_this2","Redirect","class","onSubmit","type","onChange","Login","THREE","DeviceOrientationControls","object","scope","rotation","reorder","enabled","deviceOrientation","screenOrientation","alphaOffset","onDeviceOrientationChangeEvent","onScreenOrientationChangeEvent","orientation","setObjectQuaternion","zee","Vector3","euler","Euler","q0","Quaternion","q1","Math","sqrt","quaternion","alpha","beta","orient","set","setFromEuler","multiply","setFromAxisAngle","connect","addEventListener","disconnect","removeEventListener","update","eyeAngle","device","screen","width","degToRad","dispose","CSS3DRenderer","_width","_height","_widthHalf","_heightHalf","REVISION","matrix","Matrix4","cache","camera","fov","style","objects","WeakMap","domElement","document","overflow","cameraElement","WebkitTransformStyle","transformStyle","appendChild","isIE","test","navigator","userAgent","epsilon","abs","getCameraCSSMatrix","elements","getObjectCSSMatrix","cameraCSSMatrix","matrix3d","getSize","height","setSize","getDistanceToSquared","b","object1","object2","setFromMatrixPosition","matrixWorld","distanceToSquared","zOrder","scene","sorted","result","traverse","CSS3DObject","push","filterAndFlatten","sort","distanceToCameraSquared","zMax","length","i","l","element","zIndex","render","projectionMatrix","isPerspectiveCamera","WebkitPerspective","perspective","updateMatrixWorld","parent","isOrthographicCamera","matrixWorldInverse","WebkitTransform","transform","renderObject","CSS3DSprite","copy","transpose","copyPosition","scale","cachedStyle","undefined","objectData","parentNode","children","Object3D","position","removeChild","prototype","constructor","iframeElement","ytID","x","y","z","ry","div","backgroundColor","iframe","border","url","join","imageElement","image","CSS3elementsPREV","spaceRadius","media","radius","many","angle","PI","group","Group","forEach","cos","sin","rot","newImage","add","newIFrame","Scope","_React$Component","getImage","space","init","_ref","renderer","sceneCSS","rendererCSS","controls","geometry","loader","crossOrigin","map","load","material","sphere","helperGeometry","helperMaterial","wireframe","scopeDiv","getElementById","setPixelRatio","devicePixelRatio","innerWidth","innerHeight","onWindowResize","animate","_this$state","requestAnimationFrame","_this$state2","aspect","updateProjectionMatrix","componentDidMount","componentDidUpdate","prevProps","newId","antialias","inherits","createClass","React","geolocalize","Promise","resolve","reject","geolocation","getCurrentPosition","pos","center","coords","latitude","longitude","UploadSpace","createSpace","image_url","creator","_id","location","sendNewSpace","addSpaceToUser","newSpace","updateCatalog","catalog","catalogId","spaceId","patch","userInSession","file","files","uploadImage","img_url","_this3","formData","FormData","append","headers","Content-Type","img","secure_url","_this4","handleSubmit","UploadMediaImg","createMedia","addMediaToSpace","spaceID","updateSpace","newMedia","currentSpace","textElement","text","h2","innerHTML","reactionElement","likes","r","button","borderRadius","CSS3elements","newText","reactions","Camera","cameraStart","cameraView","querySelector","mediaDevices","getUserMedia","constraints","stream","getTracks","srcObject","video","facingMode","audio","autoPlay","playsInline","ScopeCameraID","promises","mediaIDs","mediaID","all","mediaArr","prom","newPage","body","match","params","Camera_Camera","UploadMediaVideo","youtubeID","placeholder","UploadMediaText","BottomMenu","Profile","getScopes","spaces","userSpaces","ProfileID","userProfileID","isFollowing","checkFollowing","followed","profileUser","followedUserID","following","currentUserFollowing","currentUserID","includes","followUser","follow","isFollowEnabled","isFollowText","TrackballControls","STATE","NONE","ROTATE","ZOOM","PAN","TOUCH_ROTATE","TOUCH_ZOOM_PAN","left","top","rotateSpeed","zoomSpeed","panSpeed","noRotate","noZoom","noPan","staticMoving","dynamicDampingFactor","minDistance","maxDistance","Infinity","keys","lastPosition","_state","_prevState","_eye","_movePrev","Vector2","_moveCurr","_lastAxis","_lastAngle","_zoomStart","_zoomEnd","_touchZoomDistanceStart","_touchZoomDistanceEnd","_panStart","_panEnd","target0","clone","position0","up0","up","changeEvent","startEvent","endEvent","handleResize","box","getBoundingClientRect","d","ownerDocument","documentElement","pageXOffset","clientLeft","pageYOffset","clientTop","getMouseOnScreen","vector","pageX","pageY","getMouseOnCircle","keydown","keyCode","keyup","mousedown","stopPropagation","mousemove","mouseup","dispatchEvent","mousewheel","deltaMode","deltaY","touchstart","touches","dx","dy","touchmove","touchend","contextmenu","rotateCamera","axis","eyeDirection","objectUpDirection","objectSidewaysDirection","moveDirection","sub","normalize","crossVectors","setLength","applyQuaternion","zoomCamera","factor","multiplyScalar","panCamera","mouseChange","objectUp","pan","lengthSq","cross","subVectors","checkDistances","addVectors","lookAt","reset","EventDispatcher","ScopeID","owner","toogleModal","modal","menu","mediaMenu","likeListener","currrentLocation","isInLocation","isLiked","isOwner","UploadMediaImg_UploadMediaImg","UploadMediaText_UploadMediaText","UploadMediaVideo_UploadMediaVideo","disabled","Welcome","wireframeLinewidth","background","logo","Feed","getFeedScopes","usersF","catalogsF","spacesF","promFollowedUsers","promFollowedCatalogs","promFollowedSpaces","spaceLength","followedUser","FollowedUsers","FollowedCatalogs","spaceArr","FollowedSpaces","u","j","obj","feedSpaces","Map","onScriptLoad","bind","assertThisInitialized","google","maps","options","newStyleMap","StyledMapType","mapConstants","mapTypes","setMapTypeId","onMapLoad","s","getElementsByTagName","insertBefore","ExploreMap","_Component","setRedirect","getMarkers","renderRedirect","Map_Map","zoom","markers","Marker","icon","title","addListener","App","getTheUser","userObj","actualizeSpace","spaceLocation","fetchUser","Navbar_Navbar","Switch","Route","exact","path","Welcome_Welcome","Feed_Feed","assign","ExploreMap_ExploreMap","auth_Signup","auth_Login","ProfileID_ProfileID","Profile_Profile","ScopeID_ScopeID","ScopeCameraID_ScopeCameraID","UploadSpace_UploadSpace","BottomMenu_BottomMenu","Boolean","hostname","ReactDOM","BrowserRouter","src_App_0","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.961a21cc.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/scope white.7492596f.png\";","exports.COORDINATES = {\n    lat: 41.404682,\n    lng: 2.123773\n  }\n  \n  exports.API_CONFIG = {\n    key:'AIzaSyA2VCIDASPyZRdr58uKR5ucueARsagOD6s',\n    language: 'es'\n  }\n  \n  exports.resetMarkerAnimation = function ( marker ) {\n    window.setTimeout(() => {\n      marker.setAnimation( null );\n    }, 30000 );\n  }\n  \n  exports.STYLES = [\n    {\n        \"featureType\": \"all\",\n        \"elementType\": \"geometry\",\n        \"stylers\": [\n            {\n                \"color\": \"#a7e1c8\"\n            }\n        ]\n    },\n    {\n        \"featureType\": \"all\",\n        \"elementType\": \"labels.text.fill\",\n        \"stylers\": [\n            {\n                \"gamma\": 0.01\n            },\n            {\n                \"lightness\": 20\n            }\n        ]\n    },\n    {\n        \"featureType\": \"all\",\n        \"elementType\": \"labels.text.stroke\",\n        \"stylers\": [\n            {\n                \"saturation\": -31\n            },\n            {\n                \"lightness\": -33\n            },\n            {\n                \"weight\": 2\n            },\n            {\n                \"gamma\": 0.8\n            }\n        ]\n    },\n    {\n        \"featureType\": \"all\",\n        \"elementType\": \"labels.icon\",\n        \"stylers\": [\n            {\n                \"visibility\": \"off\"\n            }\n        ]\n    },\n    {\n        \"featureType\": \"landscape\",\n        \"elementType\": \"geometry\",\n        \"stylers\": [\n            {\n                \"lightness\": 30\n            },\n            {\n                \"saturation\": 30\n            }\n        ]\n    },\n    {\n        \"featureType\": \"poi\",\n        \"elementType\": \"geometry\",\n        \"stylers\": [\n            {\n                \"saturation\": 20\n            }\n        ]\n    },\n    {\n        \"featureType\": \"poi.park\",\n        \"elementType\": \"geometry\",\n        \"stylers\": [\n            {\n                \"lightness\": 20\n            },\n            {\n                \"saturation\": -20\n            }\n        ]\n    },\n    {\n        \"featureType\": \"road\",\n        \"elementType\": \"geometry\",\n        \"stylers\": [\n            {\n                \"lightness\": 10\n            },\n            {\n                \"saturation\": -30\n            }\n        ]\n    },\n    {\n        \"featureType\": \"road\",\n        \"elementType\": \"geometry.stroke\",\n        \"stylers\": [\n            {\n                \"saturation\": 25\n            },\n            {\n                \"lightness\": 25\n            }\n        ]\n    },\n    {\n        \"featureType\": \"water\",\n        \"elementType\": \"all\",\n        \"stylers\": [\n            {\n                \"lightness\": -20\n            }\n        ]\n    }\n]","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nexport default class Navbar extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { loggedInUser: null };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ ...this.state, loggedInUser: nextProps[\"userInSession\"] })\n  }\n\n  handleLogout = (e) => {\n    this.props.logout()\n  }\n\n  render() {\n    let page = this.props.page;\n    console.log(\"Page in navBar \"+ page);\n\n    if (this.state.loggedInUser && page == \"Profile\") {\n      return (\n        <nav className=\"nav-style box\" id=\"top-nav\">\n          <ul className=\"nav-width\">\n            <li className=\"has-text-danger\"><Link to='/'>Home</Link></li>\n            <li><a onClick={this.handleLogout}>Logout</a></li>\n            <li><Link to='/profile'> @{this.state.loggedInUser.username}</Link></li>\n          </ul>\n        </nav>\n      )\n    } else if (this.state.loggedInUser && page == \"ProfileID\") {\n      return (\n        <nav className=\"nav-style box\" id=\"top-nav\">\n          <ul className=\"nav-width\">\n            <li className=\"has-text-danger\"><Link to='/'>Home</Link></li>\n            {/* <li>@{this.state.loggedInUser.username}</li> */}\n            <li><Link to='/profile'><img className=\"profile-pic\" src=\"/user.svg\"></img></Link></li>\n          </ul>\n        </nav>\n      )\n    } else if (this.state.loggedInUser) {\n      return (\n        <nav className=\"nav-style box\" id=\"top-nav\">\n          <ul className=\"nav-width\">\n            <li className=\"has-text-danger\"><Link to='/'>Home</Link></li>\n            {/* <li><a onClick={this.handleLogout}>Logout</a></li> */}\n            <li><Link to='/profile'>{/* @{this.state.loggedInUser.username}*/}<img className=\"profile-pic\" src=\"/user.svg\"></img></Link></li>\n          </ul>\n        </nav>\n      )\n    } else {\n      return (\n          <nav className=\"nav-style box\" id=\"top-nav\" role=\"navigation\" aria-label=\"main navigation\">\n            <ul className=\"nav-width\">\n            <li><Link to='/'>Home</Link></li>\n            <li><Link to='/signup'>Signup</Link></li>\n            <li><Link to='/login'>Login</Link></li>\n            </ul>\n          </nav>\n      )\n    }\n  }\n}","// auth/auth-service.js\nimport axios from 'axios';\nrequire('dotenv').config();\n\nclass AuthService {\n  constructor() {\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api/auth`,\n      withCredentials: true\n    });\n  }\n\n  signup = (username, password) => {\n    return this.service.post('/signup', {username, password})\n    .then(response => response.data)\n  }\n\n  login = (username, password) => {\n    return this.service.post('/login', {username, password})\n    .then(response => response.data)\n  }\n\n  loggedin = () => {\n    return this.service.get('/currentuser',)\n    .then(response => response.data)\n    .catch(err => {\n      console.error('Error in getUser', err)\n    })\n  }\n\n  logout = () => {\n    return this.service.get('/logout',)\n    .then(response => response.data)\n  }\n}\n\nexport default AuthService;","// auth/Signup.js\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport AuthService from './AuthService'\n\nclass Signup extends Component {\n  constructor(props){\n    super(props);\n    this.state = { username: '', password: '', redirect: false };\n    this.service = new AuthService();\n  }\n    \n  handleFormSubmit = (event) => {\n    event.preventDefault();\n    const username = this.state.username;\n    const password = this.state.password;\n\n    this.service.signup(username, password)\n    .then( response => {\n        this.setState({\n            username: \"\", \n            password: \"\",\n            redirect: true\n        });\n        this.props.getUser(response.user)\n    })\n    .catch( error => console.log(error) )\n  }\n\n  handleChange = (event) => {  \n    const {name, value} = event.target;\n    this.setState({[name]: value});\n  }\n      \n\n  render() {\n    if(this.state.redirect) return <Redirect to=\"/\" />\n\n\n    return(\n      <div className=\"card box\">\n        <h3 class=\"label is-medium\">Welcome! create your account next:</h3>\n\n        <form onSubmit={this.handleFormSubmit}>\n          <div className=\"field\">\n            <label className=\"label\">Username:</label>\n            <input className=\"input\" type=\"text\" name=\"username\" value={this.state.username} onChange={ e => this.handleChange(e)}/>\n          </div>\n          \n          <div className=\"field\">\n            <label className=\"label\">Password:</label>\n            <input  className=\"input\" type=\"password\" name=\"password\" value={this.state.password} onChange={ e => this.handleChange(e)} />\n          </div>\n          \n          <input className=\"button is-primary is-rounded\" type=\"submit\" value=\"Sign up\" />\n        </form>\n\n      </div>\n    )\n  }\n}\n\nexport default Signup;","import React, { Component } from \"react\";\nimport { Redirect } from 'react-router-dom';\nimport AuthService from \"./AuthService\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { username: \"\", password: \"\", redirect: false };\n    this.service = new AuthService();\n  }\n\n  handleFormSubmit = event => {\n    event.preventDefault();\n    const username = this.state.username;\n    const password = this.state.password;\n\n    this.service\n      .login(username, password)\n      .then(response => {\n        this.setState({\n          username: username,\n          password: password,\n          error: false,\n          redirect: true\n        });\n\n        this.props.getUser(response);\n      })\n      .catch(error => {\n        this.setState({\n          username: username,\n          password: password,\n          error: true\n        });\n      });\n  };\n\n  handleChange = event => {\n    const { name, value } = event.target;\n    this.setState({ [name]: value });\n  };\n\n  render() {\n\n    if(this.state.redirect) return <Redirect to=\"/\" />\n\n    return (\n      <div className=\"card box\">\n        <h3 className=\"label is-medium\">Please, login</h3>\n        <form onSubmit={this.handleFormSubmit} >\n\n          <div className=\"field\">\n            <label className=\"label\">Username:</label>\n            <input\n              className=\"input\"\n              type=\"text\"\n              name=\"username\"\n              value={this.state.username}\n              onChange={e => this.handleChange(e)}\n            />\n          </div>\n\n          <div className=\"field\">\n            <label className=\"label\">Password:</label>\n            <input\n              className=\"input\"\n              type=\"password\"\n              name=\"password\"\n              value={this.state.password}\n              onChange={e => this.handleChange(e)}\n            />\n          </div>\n\n          <input className=\"button is-primary is-rounded\" type=\"submit\" value=\"Login\" />\n\n        </form>\n\n        <h1>{this.state.error ? \"Error\" : \"\"}</h1>\n\n        \n      </div>\n    );\n  }\n}\n\nexport default Login;\n\n","/**\n * @author richt / http://richt.me\n * @author WestLangley / http://github.com/WestLangley\n * W3C Device Orientation control (http://w3c.github.io/deviceorientation/spec-source-orientation.html)\n */\nvar THREE = require('three');\n\nTHREE.DeviceOrientationControls = function ( object ) {\n\tvar scope = this;\n\tthis.object = object;\n\tthis.object.rotation.reorder( 'YXZ' );\n\tthis.enabled = true;\n\tthis.deviceOrientation = {};\n\tthis.screenOrientation = 0;\n\tthis.alphaOffset = 0; // radians\n\n\tvar onDeviceOrientationChangeEvent = function ( event ) {\n\n\t\tscope.deviceOrientation = event;\n\t};\n\tvar onScreenOrientationChangeEvent = function () {\n\t\tscope.screenOrientation = window.orientation || 0;\n\t};\n\t// The angles alpha, beta and gamma form a set of intrinsic Tait-Bryan angles of type Z-X'-Y''\n\tvar setObjectQuaternion = function () {\n\t\tvar zee = new THREE.Vector3( 0, 0, 1 );\n\t\tvar euler = new THREE.Euler();\n\t\tvar q0 = new THREE.Quaternion();\n\t\tvar q1 = new THREE.Quaternion( - Math.sqrt( 0.5 ), 0, 0, Math.sqrt( 0.5 ) ); // - PI/2 around the x-axis\n\t\treturn function ( quaternion, alpha, beta, gamma, orient ) {\n\t\t\teuler.set( beta, alpha, - gamma, 'YXZ' ); // 'ZXY' for the device, but 'YXZ' for us\n\t\t\tquaternion.setFromEuler( euler ); // orient the device\n\t\t\tquaternion.multiply( q1 ); // camera looks out the back of the device, not the top\n\t\t\tquaternion.multiply( q0.setFromAxisAngle( zee, - orient ) ); // adjust for screen orientation\n\t\t};\n\t}();\n\tthis.connect = function () {\n\t\tonScreenOrientationChangeEvent(); // run once on load\n\t\twindow.addEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\twindow.addEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\t\tscope.enabled = true;\n\t};\n\tthis.disconnect = function () {\n\t\twindow.removeEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\twindow.removeEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\t\tscope.enabled = false;\n\t};\n\tthis.update = function () {\n\t\tlet eyeAngle;\n\t\tif ( scope.enabled === false ) return;\n\t\tvar device = scope.deviceOrientation;\n\t\tif( window.screen.width <= 740 ) {     \n\t\t\teyeAngle = 0; \n\t\t}else{\n\t\t\teyeAngle = 90;\n\t\t}\n\t\tif ( device ) {\n\t\t\tvar alpha = device.alpha ? THREE.Math.degToRad( device.alpha ) + scope.alphaOffset : 0; // Z\n\t\t\tvar beta = device.beta ? THREE.Math.degToRad( device.beta + eyeAngle) : THREE.Math.degToRad(eyeAngle); // X'\n\t\t\tvar gamma = device.gamma ? THREE.Math.degToRad( device.gamma ) : 0; // Y''\n\t\t\tvar orient = scope.screenOrientation ? THREE.Math.degToRad( scope.screenOrientation ) : 0; // O\n\t\t\tsetObjectQuaternion( scope.object.quaternion, alpha, beta, gamma, orient );\n\t\t}\n\t};\n\tthis.dispose = function () {\n\t\tscope.disconnect();\n\t};\n\tthis.connect();\n};\n\nexport default THREE.DeviceOrientationControls;","/**\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n * @author mrdoob / http://mrdoob.com/\n * @author yomotsu / https://yomotsu.net/\n */\n\nvar THREE = require('three');\n\nTHREE.CSS3DRenderer = function () {\n\n\tconsole.log( 'THREE.CSS3DRenderer', THREE.REVISION );\n\n\tvar _width, _height;\n\tvar _widthHalf, _heightHalf;\n\n\tvar matrix = new THREE.Matrix4();\n\n\tvar cache = {\n\t\tcamera: { fov: 0, style: '' },\n\t\tobjects: new WeakMap()\n\t};\n\n\tvar domElement = document.createElement( 'div' );\n\tdomElement.style.overflow = 'hidden';\n\n\tthis.domElement = domElement;\n\n\tvar cameraElement = document.createElement( 'div' );\n\n\tcameraElement.style.WebkitTransformStyle = 'preserve-3d';\n\tcameraElement.style.transformStyle = 'preserve-3d';\n\n\tdomElement.appendChild( cameraElement );\n\n\tvar isIE = /Trident/i.test( navigator.userAgent );\n\n\tthis.getSize = function () {\n\n\t\treturn {\n\t\t\twidth: _width,\n\t\t\theight: _height\n\t\t};\n\n\t};\n\n\tthis.setSize = function ( width, height ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\t\t_widthHalf = _width / 2;\n\t\t_heightHalf = _height / 2;\n\n\t\tdomElement.style.width = width + 'px';\n\t\tdomElement.style.height = height + 'px';\n\n\t\tcameraElement.style.width = width + 'px';\n\t\tcameraElement.style.height = height + 'px';\n\n\t};\n\n\tfunction epsilon( value ) {\n\n\t\treturn Math.abs( value ) < 1e-10 ? 0 : value;\n\n\t}\n\n\tfunction getCameraCSSMatrix( matrix ) {\n\n\t\tvar elements = matrix.elements;\n\n\t\treturn 'matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( - elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( elements[ 6 ] ) + ',' +\n\t\t\tepsilon( elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( - elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( - elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t}\n\n\tfunction getObjectCSSMatrix( matrix, cameraCSSMatrix ) {\n\n\t\tvar elements = matrix.elements;\n\t\tvar matrix3d = 'matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( - elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( - elements[ 6 ] ) + ',' +\n\t\t\tepsilon( - elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t\tif ( isIE ) {\n\n\t\t\treturn 'translate(-50%,-50%)' +\n\t\t\t\t'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)' +\n\t\t\t\tcameraCSSMatrix +\n\t\t\t\tmatrix3d;\n\n\t\t}\n\n\t\treturn 'translate(-50%,-50%)' + matrix3d;\n\n\t}\n\n\tfunction renderObject( object, camera, cameraCSSMatrix ) {\n\n\t\tif ( object instanceof THREE.CSS3DObject ) {\n\n\t\t\tvar style;\n\n\t\t\tif ( object instanceof THREE.CSS3DSprite ) {\n\n\t\t\t\t// http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n\n\t\t\t\tmatrix.copy( camera.matrixWorldInverse );\n\t\t\t\tmatrix.transpose();\n\t\t\t\tmatrix.copyPosition( object.matrixWorld );\n\t\t\t\tmatrix.scale( object.scale );\n\n\t\t\t\tmatrix.elements[ 3 ] = 0;\n\t\t\t\tmatrix.elements[ 7 ] = 0;\n\t\t\t\tmatrix.elements[ 11 ] = 0;\n\t\t\t\tmatrix.elements[ 15 ] = 1;\n\n\t\t\t\tstyle = getObjectCSSMatrix( matrix, cameraCSSMatrix );\n\n\t\t\t} else {\n\n\t\t\t\tstyle = getObjectCSSMatrix( object.matrixWorld, cameraCSSMatrix );\n\n\t\t\t}\n\n\t\t\tvar element = object.element;\n\t\t\tvar cachedStyle = cache.objects.get( object );\n\n\t\t\tif ( cachedStyle === undefined || cachedStyle !== style ) {\n\n\t\t\t\telement.style.WebkitTransform = style;\n\t\t\t\telement.style.transform = style;\n\n\t\t\t\tvar objectData = { style: style };\n\n\t\t\t\tif ( isIE ) {\n\n\t\t\t\t\tobjectData.distanceToCameraSquared = getDistanceToSquared( camera, object );\n\n\t\t\t\t}\n\n\t\t\t\tcache.objects.set( object, objectData );\n\n\t\t\t}\n\n\t\t\tif ( element.parentNode !== cameraElement ) {\n\n\t\t\t\tcameraElement.appendChild( element );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( object.children[ i ], camera, cameraCSSMatrix );\n\n\t\t}\n\n\t}\n\n\tvar getDistanceToSquared = function () {\n\n\t\tvar a = new THREE.Vector3();\n\t\tvar b = new THREE.Vector3();\n\n\t\treturn function ( object1, object2 ) {\n\n\t\t\ta.setFromMatrixPosition( object1.matrixWorld );\n\t\t\tb.setFromMatrixPosition( object2.matrixWorld );\n\n\t\t\treturn a.distanceToSquared( b );\n\n\t\t};\n\n\t}();\n\n\tfunction filterAndFlatten( scene ) {\n\n\t\tvar result = [];\n\n\t\tscene.traverse( function ( object ) {\n\n\t\t\tif ( object instanceof THREE.CSS3DObject ) result.push( object );\n\n\t\t} );\n\n\t\treturn result;\n\n\t}\n\n\tfunction zOrder( scene ) {\n\n\t\tvar sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n\t\t\tvar distanceA = cache.objects.get( a ).distanceToCameraSquared;\n\t\t\tvar distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n\t\t\treturn distanceA - distanceB;\n\n\t\t} );\n\n\t\tvar zMax = sorted.length;\n\n\t\tfor ( var i = 0, l = sorted.length; i < l; i ++ ) {\n\n\t\t\tsorted[ i ].element.style.zIndex = zMax - i;\n\n\t\t}\n\n\t}\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tvar fov = camera.projectionMatrix.elements[ 5 ] * _heightHalf;\n\n\t\tif ( cache.camera.fov !== fov ) {\n\n\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\tdomElement.style.WebkitPerspective = fov + 'px';\n\t\t\t\tdomElement.style.perspective = fov + 'px';\n\n\t\t\t}\n\n\t\t\tcache.camera.fov = fov;\n\n\t\t}\n\n\t\tscene.updateMatrixWorld();\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tvar cameraCSSMatrix = camera.isOrthographicCamera ?\n\t\t\t'scale(' + fov + ')' + getCameraCSSMatrix( camera.matrixWorldInverse ) :\n\t\t\t'translateZ(' + fov + 'px)' + getCameraCSSMatrix( camera.matrixWorldInverse );\n\n\t\tvar style = cameraCSSMatrix +\n\t\t\t'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)';\n\n\t\tif ( cache.camera.style !== style && ! isIE ) {\n\n\t\t\tcameraElement.style.WebkitTransform = style;\n\t\t\tcameraElement.style.transform = style;\n\n\t\t\tcache.camera.style = style;\n\n\t\t}\n\n\t\trenderObject( scene, camera, cameraCSSMatrix );\n\n\t\tif ( isIE ) {\n\n\t\t\t// IE10 and 11 does not support 'preserve-3d'.\n\t\t\t// Thus, z-order in 3D will not work.\n\t\t\t// We have to calc z-order manually and set CSS z-index for IE.\n\t\t\t// FYI: z-index can't handle object intersection\n\t\t\tzOrder( scene );\n\n\t\t}\n\n\t};\n\n};\n\n\nexport default THREE.CSS3DRenderer;","var THREE = require('three');\n//import CSS3DObject from \".../lib/CSS3DObject\";\n\n\nvar THREE = require('three');\n\nTHREE.CSS3DObject = function ( element ) {\n\tTHREE.Object3D.call( this );\n\tthis.element = element;\n\tthis.element.style.position = 'absolute';\n\tthis.addEventListener( 'removed', function () {\n\t\tif ( this.element.parentNode !== null ) {\n\t\t\tthis.element.parentNode.removeChild( this.element );\n\t\t}\n\t} );\n};\nTHREE.CSS3DObject.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.CSS3DObject.prototype.constructor = THREE.CSS3DObject;\nTHREE.CSS3DSprite = function ( element ) {\n\tTHREE.CSS3DObject.call( this, element );\n};\nTHREE.CSS3DSprite.prototype = Object.create( THREE.CSS3DObject.prototype );\nTHREE.CSS3DSprite.prototype.constructor = THREE.CSS3DSprite;\n\nlet elementSize = 200;\n\nconst iframeElement = (ytID, x, y, z, ry) =>{\n    var div = document.createElement( 'div' );\n    div.style.width = `${elementSize}px`;\n    //div.style.height = '360px';\n    div.style.backgroundColor = '#000';\n    var iframe = document.createElement( 'iframe' );\n    //iframe.style.width = \"480px\";\n    //iframe.style.height = '360px';\n    iframe.style.border = '0px';\n    let url = [ 'https://www.youtube.com/embed/', ytID, '?rel=0' ].join( '' );\n    iframe.src = url;\n    div.appendChild( iframe );\n    var object = new THREE.CSS3DObject( div );\n    object.position.set( x, y, z );\n    object.rotation.y = ry;\n    console.log(ytID);\n    console.log(url);\n    return object;\n}\nconst imageElement = (url, x, y, z, ry) =>{\n    var div = document.createElement( 'div' );\n    //div.style.width = '50px';\n    //div.style.height = '50px';\n    div.style.backgroundColor = '#000';\n    var image = document.createElement( 'img' );\n    image.style.border = '0px';\n    image.src = url;//\"https://scontent-mad1-1.cdninstagram.com/vp/30f76f820acdb893b9cb648ae0adfd57/5C5FEA68/t51.2885-15/e35/25018699_872711359576719_1019478494217764864_n.jpg\";\n    image.style.width = `${elementSize}px`;\n    image.style.height = 'auto';\n    div.appendChild( image );\n    var object = new THREE.CSS3DObject( div );\n    object.position.set( x, y, z );\n    object.rotation.y = ry;\n    console.log(url);\n    return object;\n}\n\nexport const CSS3elementsPREV = (spaceRadius, media) => {\n    let radius = spaceRadius-50;\n    let many = media.length;\n    let angle = Math.PI * 2 / many;\n    let x,z;\n    let y = 0;//spaceRadius/2;\n    let group = new THREE.Group();\n    media.forEach((e,i) => {\n        let ry = angle * i;\n        x = radius * Math.cos(ry);\n        z = radius * Math.sin(ry);\n        let rot = 3*Math.PI/2 - ry;\n        if (e.type == \"IMAGE\"){\n            let newImage = new imageElement(e.url, x, y, z, rot);\n            //console.log(e);\n            group.add(newImage);\n        } else if (e.type == \"YOUTUBE\"){\n            //console.log(e);\n            let newIFrame = new iframeElement(e.url, x, y, z, rot);\n            group.add(newIFrame);\n        }else {\n            let newIFrame = new iframeElement(e, x, y, z, rot);\n            group.add(newIFrame);\n        }\n    });\n    return group;\n}","import React from \"react\";\nimport * as THREE from \"three\";\nimport DeviceOrientationControls from \"../../lib/DeviceOrientationControls\";\n//import TrackballControls from \"../../lib/TrackballControls\";\nimport CSS3DRenderer from \"../../lib/CSS3DRenderer\";\nimport {CSS3elementsPREV} from \"./CSS3elementsPREV\";\nimport axios from \"axios\";\nrequire('dotenv').config();\n\n\nexport class Scope extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      spaceRadius: 500,\n      camera: new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1100),\n      scene: new THREE.Scene(),\n      sceneCSS: new THREE.Scene(), \n      renderer: new THREE.WebGLRenderer({ antialias: true }),\n      rendererCSS: new CSS3DRenderer(), \n      id: this.props.id\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  getImage = (id) => {\n    return this.service\n      .get(`/spaces/${id}`)\n      .then(space => {\n        console.log(\"Image from DB \" + space.data);\n        this.setState({ image: space.data.image, media: space.data.media });\n      })\n      .catch(error => console.log(error));\n  };\n\n  init = ({ camera, scene, renderer, sceneCSS, rendererCSS }) => {\n    this.setState({ controls: new DeviceOrientationControls(camera) });\n    /* this.setState({ controls: new TrackballControls(camera) });\n    this.state.controls.rotateSpeed = 1.0;\n    this.state.controls.zoomSpeed = 1.2;\n    this.state.controls.panSpeed = 0.8; */\n    camera.position.set(0, 0, -0.0001); //-0.001\n\n    renderer.domElement.className = \"scope\";\n    rendererCSS.domElement.className = \"scopeCSS\";\n    \n    //Panorama Sphere\n    var geometry = new THREE.SphereBufferGeometry(this.state.spaceRadius, 60, 40);\n    geometry.scale(-1, 1, 1); // invert the geometry on the x-axis so that all of the faces point inward\n    const loader = new THREE.TextureLoader();\n    loader.crossOrigin = \"\";\n    const map = loader.load(this.state.image);\n    var material = new THREE.MeshBasicMaterial({ map });\n    var sphere = new THREE.Mesh(geometry, material);\n    scene.add(sphere);\n    \n    //Helper Geometry\n    var helperGeometry = new THREE.BoxBufferGeometry(100, 100, 100, 4, 4, 4);\n    var helperMaterial = new THREE.MeshBasicMaterial({color: 0xff00ff, wireframe: true});\n    var helper = new THREE.Mesh(helperGeometry, helperMaterial);\n    //scene.add(helper);\n\n    console.log(\"MEDIA FROM THIS SPACE DB\");\n    console.log(this.state.media);\n    let group = CSS3elementsPREV (this.state.spaceRadius, this.state.media);\n    sceneCSS.add(group);\n\n    let scopeDiv = document.getElementById(\"scopediv\");\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    //document.body.appendChild(renderer.domElement);\n    scopeDiv.appendChild(renderer.domElement);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n    //document.body.appendChild(rendererCSS.domElement);\n    scopeDiv.appendChild(rendererCSS.domElement);\n    window.addEventListener(\"resize\", this.onWindowResize, false);\n  };\n\n  animate = () => {\n    let { camera, scene, renderer, sceneCSS, rendererCSS, controls } = this.state;\n    window.requestAnimationFrame(this.animate);\n    controls.update();\n    renderer.render(scene, camera);\n    rendererCSS.render(sceneCSS, camera);\n  };\n\n  onWindowResize = () => {\n    let { camera, renderer, rendererCSS } = this.state;\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n  };\n\n  componentDidMount = () => {\n    let id = this.state.id;\n    //console.log(\"FIRST ID \"+id)\n    this.getImage(id).then(() => {\n      this.init(this.state);\n      this.animate();\n    });\n  };\n\n  componentDidUpdate = prevProps => {\n    if (this.props.id !== prevProps.id) {\n      let newId = this.props.id;\n      this.setState({ id: newId });\n      this.getImage(newId).then(() => {\n        this.init(this.state);\n        this.animate();\n      });\n    }\n  };\n\n  render() {\n    return <div id=\"scopediv\"/>;\n  }\n}\n","const geolocalize = () => {\n  return new Promise((resolve, reject) => {\n    if (!navigator.geolocation) reject(\"No geolocation available\");\n    navigator.geolocation.getCurrentPosition(pos => {\n      const center = {\n        lat: pos.coords.latitude,\n        lng: pos.coords.longitude\n      };\n      resolve(center);\n    }, reject);\n  });\n};\n\n\nexport default geolocalize;","import React, { Component } from \"react\";\nimport { Scope } from \"./3dSpace/Scope\";\n\nexport class ScopeView extends Component {\n    render() {\n      return (\n          <div className=\"ScopeView\">\n            <Scope id={this.props.id}/>\n          </div>\n      );\n    }\n  }","import React from \"react\";\nimport { Redirect } from 'react-router-dom';\nimport axios from \"axios\";\nimport geolocalize from \"../maps/geolocalize\";\nrequire('dotenv').config();\n\nexport class UploadSpace extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { loggedInUser: this.props.userInSession, redirect: false };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ ...this.state, loggedInUser: nextProps[\"userInSession\"] })\n  }\n\n  handleChange(e) {\n    this.setState({\n      file: e.target.files[0]\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    this.uploadImage(this.state.file).then(() => {\n      console.log(\"uploaded image to create space\");\n      console.log(this.state.img_url);\n      geolocalize().then(center => {\n        console.log(center);\n        this.createSpace(this.state.img_url, center);\n      });\n    });\n  }\n\n  uploadImage(file) {\n    const formData = new FormData();\n    formData.append(\"photo\", file);\n    return this.service\n      .post(\"/uploadCloud\", formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" }\n      })\n      .then(img => {\n        this.setState({ img_url: img.data.secure_url, redirect: true });\n      })\n      .catch(error => console.log(error));\n  }\n\n  createSpace = (image_url, center) => {\n    let { lat, lng } = center;\n    console.log(center);\n    let user = this.state.loggedInUser;\n    console.log(\"USER IN CREATE SPACE\");\n    console.log(user);\n    let space = { image: image_url, creator: user._id, location: center };\n    return this.service\n      .post(\"/spaces\", space)\n      .then(space => {\n        console.log(\"CREATED NEW SPACE:\");\n        console.log(space.data);\n        this.sendNewSpace(space.data);\n        this.addSpaceToUser(space.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n  sendNewSpace = space => {\n    this.props.newSpace(space._id, space.location);\n  };\n\n  addSpaceToUser = space => {\n    let user = this.state.loggedInUser;\n    console.log(\"ADD TO USER CATALOG\");\n    console.log(space);\n    console.log(user);\n    this.updateCatalog(user.catalog, space._id);\n  };\n\n  updateCatalog = (catalogId, spaceId) => {\n    let newSpace = { spaceId };\n    return this.service\n      .patch(`/catalog/${catalogId}`, newSpace)\n      .then(catalog => {\n        console.log(\"Catalog updated on DB \" + catalog.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n  render() {\n\n    if(this.state.redirect) return <Redirect to=\"/\" />\n\n    return (\n      <div className=\"form-card box\">\n        <div className=\"file\">\n          <form onSubmit={e => this.handleSubmit(e)}>\n            <label className=\"file-label\">\n              <input className=\"file-input\" type=\"file\" onChange={e => this.handleChange(e)} />\n              <span className=\"file-cta\">\n                <span className=\"file-label\">Take a panoramic photo</span>\n              </span>\n            </label>\n            <button className=\"button is-primary\" type=\"submit\">Upload</button>\n          </form>\n\n        </div>\n      </div>\n    );\n  }\n}\n\n\n\n\n\n","import React from \"react\";\nimport { Redirect } from 'react-router-dom';\nimport axios from \"axios\";\nrequire('dotenv').config();\n\nexport class UploadMediaImg extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { \n      loggedInUser: this.props.userInSession,\n      spaceID: this.props.currentSpace, \n      redirect: false\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  handleChange(e) {\n    this.setState({\n      file: e.target.files[0]\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    this.uploadImage(this.state.file)\n    .then(() => {\n      console.log(\"uploaded image to this space\");\n      console.log(this.state.img_url);\n      this.createMedia(this.state.img_url);\n    });\n  }\n\n  uploadImage(file) {\n    const formData = new FormData();\n    formData.append(\"photo\", file);\n    //console.log(\"DEBUG formData\", formData.get(\"photo\"));\n    return this.service\n      .post(\"/uploadCloud\", formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" }\n      })\n      .then(img => {\n        this.setState({ img_url: img.data.secure_url, redirect: true });\n      })\n      .catch(error => console.log(error));\n  }\n\n  createMedia = (image_url) => {\n    let media = { url: image_url, type: \"IMAGE\"};\n    return this.service\n      .post(\"/media\", media)\n      .then(media => {\n        console.log(\"CREATED NEW IMAGE:\");\n        console.log(media.data);\n        this.addMediaToSpace(media.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n\n  addMediaToSpace = media => {\n    let spaceID = this.state.spaceID;\n    console.log(\"SPACE ID UPLOAD IMG \"+ spaceID)\n    this.updateSpace(media, spaceID);\n  };\n\n  updateSpace = (media, spaceId) => {\n    let newMedia = media;\n    return this.service\n      .patch(`/spaces/${spaceId}`, newMedia)\n      .then(space => {\n        console.log(\"Space updated on DB \" + space.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n  render() {\n    \n    console.log(\"SPACE ID UPLOAD IMG \"+ this.state.spaceID);\n\n    if(this.state.redirect) return <Redirect to=\"/\" />\n\n    return (\n      <div className=\"form-card\">\n        <div className=\"file\">\n          <form onSubmit={e => this.handleSubmit(e)}>\n          <label className=\"file-label\">\n            <input className=\"file-input\" type=\"file\" onChange={e => this.handleChange(e)} /> <br />\n            <span className=\"file-cta\">\n              <span className=\"file-label\">Add an image to this Scope</span>\n            </span>\n            </label>\n            <button type=\"submit\" className=\"button is-primary\">Upload</button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n","var THREE = require(\"three\");\n\nvar THREE = require(\"three\");\n\nTHREE.CSS3DObject = function(element) {\n  THREE.Object3D.call(this);\n  this.element = element;\n  this.element.style.position = \"absolute\";\n  this.addEventListener(\"removed\", function() {\n    if (this.element.parentNode !== null) {\n      this.element.parentNode.removeChild(this.element);\n    }\n  });\n};\nTHREE.CSS3DObject.prototype = Object.create(THREE.Object3D.prototype);\nTHREE.CSS3DObject.prototype.constructor = THREE.CSS3DObject;\nTHREE.CSS3DSprite = function(element) {\n  THREE.CSS3DObject.call(this, element);\n};\nTHREE.CSS3DSprite.prototype = Object.create(THREE.CSS3DObject.prototype);\nTHREE.CSS3DSprite.prototype.constructor = THREE.CSS3DSprite;\n\nlet elementSize = 200;\n\nconst iframeElement = (ytID, x, y, z, ry) => {\n  var div = document.createElement(\"div\");\n  div.style.width = `${elementSize}px`;\n  //div.style.height = '360px';\n  div.style.backgroundColor = \"#000\";\n  var iframe = document.createElement(\"iframe\");\n  //iframe.style.width = \"480px\";\n  //iframe.style.height = '360px';\n  iframe.style.border = \"0px\";\n  //ytID = \"B-DuL2W71W4\";\n  let url = [\"https://www.youtube.com/embed/\", ytID, \"?rel=0\"].join(\"\");\n  iframe.src = url;\n  div.appendChild(iframe);\n  var object = new THREE.CSS3DObject(div);\n  object.position.set(x, y, z);\n  object.rotation.y = ry;\n  //console.log(ytID);\n  //console.log(url);\n  return object;\n};\nconst imageElement = (url, x, y, z, ry) => {\n  var div = document.createElement(\"div\");\n  //div.style.width = '50px';\n  //div.style.height = '50px';\n  div.style.backgroundColor = \"#000\";\n  var image = document.createElement(\"img\");\n  image.style.border = \"0px\";\n  image.src = url; // */\"https://scontent-mad1-1.cdninstagram.com/vp/30f76f820acdb893b9cb648ae0adfd57/5C5FEA68/t51.2885-15/e35/25018699_872711359576719_1019478494217764864_n.jpg\";\n  image.style.width = `${elementSize}px`;\n  image.style.height = \"auto\";\n  div.appendChild(image);\n  var object = new THREE.CSS3DObject(div);\n  object.position.set(x, y, z);\n  object.rotation.y = ry;\n  //console.log(url);\n  return object;\n};\n\nconst textElement = (text, x, y, z, ry) => {\n  var div = document.createElement(\"div\");\n  //div.style.width = `${elementSize}px`;\n  //div.style.height = `${elementSize}px`;\n  div.className = \"div-on-scope\";\n  var h2 = document.createElement(\"h2\");\n  h2.className = \"text-on-scope\"\n  h2.innerHTML = text; \n  div.appendChild(h2);\n  var object = new THREE.CSS3DObject(div);\n  object.position.set(x, y, z);\n  object.rotation.y = ry;\n  //console.log(text);\n  return object;\n};\n\nconst reactionElement = (likes,r) => {\n  let x = 0;\n  let y = r;\n  let z = 0;\n  var div = document.createElement(\"div\");\n  var button = document.createElement(\"BUTTON\");\n  button.className = \"button is-primary\"; //\n  button.id = \"like-button\";\n  button.style.borderRadius = \"30px\";\n  button.innerHTML = \"LIKE\";\n  button.style.width = \"60px\";\n  button.style.height = \"60px\";\n  div.appendChild(button);\n  var object = new THREE.CSS3DObject(div);\n  object.position.set(x, y, z);\n  object.rotation.x = -Math.PI / 2;\n  object.rotation.z = Math.PI;\n  return object;\n};\n\nexport const CSS3elements = (spaceRadius, media, likes) => {\n  console.log(\"MEDIA SEND TO CSS ELEMENTS\");\n  console.log(media);\n  let radius = spaceRadius - 50;\n  let many = media.length;\n  let angle = (Math.PI * 2) / many;\n  let x, z;\n  let y = 0; //spaceRadius/2;\n  let group = new THREE.Group();\n  media.forEach((e, i) => {\n    let ry = angle * i;\n    x = radius * Math.cos(ry);\n    z = radius * Math.sin(ry);\n    let rot = (3 * Math.PI) / 2 - ry;\n    if (e.type == \"IMAGE\") {\n      let newImage = new imageElement(e.url, x, y, z, rot);\n      group.add(newImage);\n    } else if (e.type == \"YOUTUBE\") {\n      let newIFrame = new iframeElement(e.url, x, y, z, rot);\n      group.add(newIFrame);\n    } else if (e.type == \"TEXT\") {\n      let newText = new textElement(e.url, x, y, z, rot);\n      group.add(newText);\n    } else {\n      console.log(e);\n      let newIFrame = new iframeElement(e, x, y, z, rot);\n      group.add(newIFrame);\n    }\n    let reactions = new reactionElement(likes, -radius);\n    group.add(reactions);\n  });\n  return group;\n};\n","import React from \"react\";\n\nexport class Camera extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      cameraView: document.querySelector(\"#camera--view\"),\n      constraints: { video: { facingMode: \"environment\" }, audio: false }\n    };\n  }\n\n \n\n  cameraStart = () => {\n    let cameraView = document.querySelector(\"#camera--view\");\n    navigator.mediaDevices\n      .getUserMedia(this.state.constraints)\n      .then(function(stream) {\n        let track = stream.getTracks()[0];\n        cameraView.srcObject = stream;\n      })\n      .catch(function(error) {\n        console.error(\"Oops. Something is broken.\", error);\n      });\n  };\n\n  componentDidMount=()=>{\n    this.cameraStart();\n  }\n\n  render() {\n    return (\n      <video className=\"camera\"id=\"camera--view\" autoPlay playsInline />      \n    );\n  }\n}\n","import React from \"react\";\nimport * as THREE from \"three\";\nimport DeviceOrientationControls from \"../../lib/DeviceOrientationControls\";\nimport CSS3DRenderer from \"../../lib/CSS3DRenderer\";\nimport {CSS3elements} from \"./CSS3elements\";\nimport { Camera } from \"../Camera\";\nimport axios from \"axios\";\nrequire('dotenv').config();\n\n\nexport class ScopeCamera extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      spaceRadius: 500,\n      camera: new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1100),\n      scene: new THREE.Scene(),\n      sceneCSS: new THREE.Scene(), \n      renderer: new THREE.WebGLRenderer({ antialias: true }),\n      rendererCSS: new CSS3DRenderer(), \n      id: this.props.id\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  getImage = (id) => {\n    return this.service\n      .get(`/spaces/${id}`)\n      .then(space => {\n        this.setState({ image: space.data.image, media: space.data.media });\n        console.log(\"Image from DB \" + space.data.image);\n      })\n      .catch(error => console.log(error));\n  };\n\n  init = ({ camera, scene, renderer, sceneCSS, rendererCSS }) => {\n    this.setState({ controls: new DeviceOrientationControls(camera) });\n  \n    camera.position.set(0, 0, -0.0001); //-0.001\n\n    renderer.domElement.className = \"scopehidden\";\n    rendererCSS.domElement.className = \"scopeCSS\";\n    \n    //Panorama Sphere\n    var geometry = new THREE.SphereBufferGeometry(this.state.spaceRadius, 60, 40);\n    geometry.scale(-1, 1, 1); // invert the geometry on the x-axis so that all of the faces point inward\n    const loader = new THREE.TextureLoader();\n    loader.crossOrigin = \"\";\n    const map = loader.load(this.state.image);\n    var material = new THREE.MeshBasicMaterial({ map });\n    var sphere = new THREE.Mesh(geometry, material);\n    scene.add(sphere);\n    \n    //Helper Geometry\n    var helperGeometry = new THREE.BoxBufferGeometry(100, 100, 100, 4, 4, 4);\n    var helperMaterial = new THREE.MeshBasicMaterial({color: 0xff00ff, wireframe: true});\n    var helper = new THREE.Mesh(helperGeometry, helperMaterial);\n    //scene.add(helper);\n\n    let media = this.state.media;\n    let group;\n    console.log(\"MEDIA FROM THIS SPACE DB\");\n    console.log(media);\n    if(media!=undefined){\n      group = CSS3elements (this.state.spaceRadius, media);\n      console.log(group);\n      sceneCSS.add(group);\n    }\n\n\n\n    let scopeDiv = document.getElementById(\"scopecamdiv\");\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    document.body.appendChild(renderer.domElement);\n    scopeDiv.appendChild(renderer.domElement);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n    //document.body.appendChild(rendererCSS.domElement);\n    scopeDiv.appendChild(rendererCSS.domElement);\n    window.addEventListener(\"resize\", this.onWindowResize, false);\n  };\n\n  animate = () => {\n    let { camera, scene, renderer, sceneCSS, rendererCSS, controls } = this.state;\n    window.requestAnimationFrame(this.animate);\n    controls.update();\n    renderer.render(scene, camera);\n    rendererCSS.render(sceneCSS, camera);\n  };\n\n  onWindowResize = () => {\n    let { camera, renderer, rendererCSS } = this.state;\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n  };\n\n  componentDidMount = () => {\n    let id = this.state.id;\n    //console.log(\"FIRST ID \"+id)\n    this.getImage(id).then(() => {\n      this.init(this.state);\n      this.animate();\n    });\n  };\n\n  componentDidUpdate = prevProps => {\n    if (this.props.id !== prevProps.id) {\n      let newId = this.props.id;\n      this.setState({ id: newId });\n      this.getImage(newId).then(() => {\n        this.init(this.state);\n        this.animate();\n      });\n    }\n  };\n\n  render() {\n    return <div id=\"scopecamdiv\"><Camera/></div>;\n  }\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport * as THREE from \"three\";\nimport DeviceOrientationControls from \"../../lib/DeviceOrientationControls\";\nimport CSS3DRenderer from \"../../lib/CSS3DRenderer\";\nimport {CSS3elements} from \"./CSS3elements\";\nimport { Camera } from \"../Camera\";\nimport axios from \"axios\";\nrequire('dotenv').config();\n\n\nexport class ScopeCameraID extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      spaceRadius: 500,\n      camera: new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1100),\n      scene: new THREE.Scene(),\n      sceneCSS: new THREE.Scene(), \n      renderer: new THREE.WebGLRenderer({ antialias: true }),\n      rendererCSS: new CSS3DRenderer()\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  getImage = (id) => {\n    let promises = [];\n    return this.service\n      .get(`/spaces/${id}`)\n      .then(space => {\n        this.setState({ image: space.data.image, mediaIDs: space.data.media });\n        this.sendNewSpace(space.data);\n        console.log(\"Image from DB \" + space.data.image);\n      })\n      .then(()=>{\n        let mediaIDs = this.state.mediaIDs;\n        mediaIDs.forEach(mediaID => {\n            if (typeof mediaID == \"object\"){\n                mediaID = mediaID._id;\n            }\n          promises.push(this.service.get(`/media/${mediaID}`));\n        });\n        return Promise.all(promises);\n      })\n      .then(promises => {\n        let mediaArr=[];\n        promises.forEach(prom => {\n          mediaArr.push(prom.data);\n        })\n        this.setState({media: mediaArr});\n        console.log(\"MEDIA OBJECTS IN STATE\");\n        console.log(this.state.media);\n      })\n      .catch(error => console.log(error));\n  };\n\n  sendNewSpace = space => {\n    this.props.newSpace(space._id, space.location);\n    this.props.newPage();\n  }; \n\n  init = ({ camera, scene, renderer, sceneCSS, rendererCSS }) => {\n    this.setState({ controls: new DeviceOrientationControls(camera) });\n  \n    camera.position.set(0, 0, -0.0001); //-0.001\n\n    renderer.domElement.className = \"scopehidden\";\n    rendererCSS.domElement.className = \"scopeCSS\";\n    \n    //Panorama Sphere\n    var geometry = new THREE.SphereBufferGeometry(this.state.spaceRadius, 60, 40);\n    geometry.scale(-1, 1, 1); // invert the geometry on the x-axis so that all of the faces point inward\n    const loader = new THREE.TextureLoader();\n    loader.crossOrigin = \"\";\n    const map = loader.load(this.state.image);\n    var material = new THREE.MeshBasicMaterial({ map });\n    var sphere = new THREE.Mesh(geometry, material);\n    scene.add(sphere);\n\n    let media = this.state.media;\n    let group;\n    console.log(\"MEDIA FROM THIS SPACE DB\");\n    console.log(media);\n    if(media!==undefined){\n      group = CSS3elements (this.state.spaceRadius, media);\n      console.log(group);\n      sceneCSS.add(group);\n    }\n\n    let scopeDiv = document.getElementById(\"scopecamdiv\");\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    document.body.appendChild(renderer.domElement);\n    scopeDiv.appendChild(renderer.domElement);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n    document.body.appendChild(rendererCSS.domElement);\n    scopeDiv.appendChild(rendererCSS.domElement);\n    window.addEventListener(\"resize\", this.onWindowResize, false);\n  };\n\n  animate = () => {\n    let { camera, scene, renderer, sceneCSS, rendererCSS, controls } = this.state;\n    window.requestAnimationFrame(this.animate);\n    controls.update();\n    renderer.render(scene, camera);\n    rendererCSS.render(sceneCSS, camera);\n  };\n\n  onWindowResize = () => {\n    let { camera, renderer, rendererCSS } = this.state;\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n  };\n\n  componentDidMount = () => {\n    let id =  this.props.match.params.id;\n    this.setState({id: id});\n    this.getImage(id).then(() => {\n      this.init(this.state);\n      this.animate();\n    });\n  };\n\n\n  render() {\n    let id =  this.props.match.params.id;\n    console.log(\"id a route scope \"+id);\n    return (\n        <div id=\"scopecamdiv\">\n                <button className=\"button is-danger is-outlined is-rounded switch-button danger\"><Link to={`/scope/${id}`}>AR</Link></button>\n            <Camera/>\n        </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nrequire(\"dotenv\").config();\n\nexport class UploadMediaVideo extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loggedInUser: this.props.userInSession,\n      spaceID: this.props.currentSpace,\n      youtubeID: \"\",\n      redirect: false\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    console.log(\"uploaded youtube video to this space\");\n    console.log(this.state.img_url);\n    this.createMedia(this.state.youtubeID);\n    this.setState({ redirect: true });\n  }\n\n  handleChange = event => {\n    console.log(event);\n    const value = event.target.value;\n    this.setState({ youtubeID: value });\n  };\n\n  createMedia = youtubeID => {\n    let media = { url: youtubeID, type: \"YOUTUBE\" };\n    return this.service\n      .post(\"/media\", media)\n      .then(media => {\n        console.log(\"CREATED NEW YOUTUBE VIDEO:\");\n        console.log(media.data);\n        this.addMediaToSpace(media.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n  addMediaToSpace = media => {\n    let spaceID = this.state.spaceID;\n    this.updateSpace(media, spaceID);\n  };\n\n  updateSpace = (media, spaceId) => {\n    let newMedia = media;\n    return this.service\n      .patch(`/spaces/${spaceId}`, newMedia)\n      .then(space => {\n        console.log(\"Space updated on DB \" + space.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n  render() {\n    console.log(\"SPACE ID UPLOAD VIDEO \" + this.state.spaceID);\n\n    if (this.state.redirect) return <Redirect to=\"/\" />;\n\n    return (\n      <div className=\"form-card\">\n        <div class=\"field\">\n          <form onSubmit={e => this.handleSubmit(e)}>\n          <label class=\"label\">Add a YouTube video to this Scope</label>\n            <div class=\"control\">\n              <input\n                className=\"input is-primary\"\n                type=\"text\"\n                name=\"youtubeID\"\n                onChange={e => this.handleChange(e)}\n                placeholder=\"VVsCOnWGHh8\"\n              />\n            </div>\n            <button className=\"button is-primary\" type=\"submit\">\n              Upload\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nrequire(\"dotenv\").config();\n\nexport class UploadMediaText extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loggedInUser: this.props.userInSession,\n      spaceID: this.props.currentSpace,\n      text: \"\",\n      redirect: false\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    console.log(\"uploaded youtube video to this space\");\n    console.log(this.state.img_url);\n    this.createMedia(this.state.text);\n    this.setState({ redirect: true });\n  }\n\n  handleChange = event => {\n    console.log(event);\n    const value = event.target.value;\n    this.setState({ text: value });\n  };\n\n  createMedia = text => {\n    let media = { url: text, type: \"TEXT\" };\n    return this.service\n      .post(\"/media\", media)\n      .then(media => {\n        console.log(\"CREATED NEW YOUTUBE VIDEO:\");\n        console.log(media.data);\n        this.addMediaToSpace(media.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n  addMediaToSpace = media => {\n    let spaceID = this.state.spaceID;\n    this.updateSpace(media, spaceID);\n  };\n\n  updateSpace = (media, spaceId) => {\n    let newMedia = media;\n    return this.service\n      .patch(`/spaces/${spaceId}`, newMedia)\n      .then(space => {\n        console.log(\"Space updated on DB \" + space.data);\n      })\n      .catch(error => console.log(error));\n  };\n\n  render() {\n    console.log(\"SPACE ID UPLOAD TEXT \" + this.state.spaceID);\n\n    if (this.state.redirect) return <Redirect to=\"/\" />;\n\n    return (\n      <div className=\"form-card\">\n        <div class=\"field\">\n          <form onSubmit={e => this.handleSubmit(e)}>\n          <label class=\"label\">Add a quote to this Scope</label>\n            <div class=\"control\">\n              <input\n                className=\"input is-primary\"\n                type=\"text\"\n                name=\"youtubeID\"\n                onChange={e => this.handleChange(e)}\n                placeholder=\"Say something\"\n              />\n            </div>\n            <button className=\"button is-primary\" type=\"submit\">\n              Upload\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport default class BottomMenu extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { loggedInUser: null };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ ...this.state, loggedInUser: nextProps[\"userInSession\"] })\n  }\n\n  render() {\n  let page = this.props.page;\n  console.log(\"Page in bottomMenu \"+ page);\n\n    if(page == \"Scope\"){\n      return <div/>\n    }\n\n   if (this.state.loggedInUser && page !== \"Scope\") {\n      return (\n        <nav className=\"nav-style box\" id=\"bottom-nav\">\n          <ul className=\"nav-width\">\n            <li><Link to='/feed'>Friends</Link></li>\n            <li><Link to='/upload-scope/'><img className=\"profile-pic\" src=\"/add.svg\"></img></Link>{/* </button> */}</li>\n            <li><Link to='/explore'>Explore</Link></li>\n          </ul>\n        </nav>\n      )\n    } else {\n      return (\n          <nav className=\"nav-style box\" id=\"bottom-nav\" role=\"navigation\" aria-label=\"main navigation\">\n            <ul>\n              <li><Link to='/explore'>Explore</Link></li>\n            </ul>\n          </nav>\n          \n      )\n    }\n  }\n}\n\n\n","import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport { Navbar, NavbarMenu, NavbarItem } from \"bloomer\";\nrequire(\"dotenv\").config();\n\nexport default class Profile extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { loggedInUser: props.userInSession };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n    this.getScopes();\n    this.props.newPage();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ ...this.state, loggedInUser: nextProps[\"userInSession\"] });\n  }\n\n  getScopes = () => {\n    let catalogId = this.props.userInSession.catalog;\n    let promises = [];\n    this.setState({ catalogId: catalogId });\n    return this.service\n      .get(`/catalog/${catalogId}`)\n      .then(catalog => {\n        let spacesId = catalog.data.spaces;\n        spacesId.forEach(spaceId => {\n          promises.push(this.service.get(`/spaces/${spaceId}`));\n        });\n        return Promise.all(promises);\n      })\n      .then(promises => {\n        let spaces = [];\n        promises.forEach(prom => {\n          spaces.push(prom.data);\n        });\n        this.setState({ userSpaces: spaces });\n      })\n      .catch(error => console.log(error));\n  };\n\n  render() {\n    if (this.props.userInSession) {\n      let userSpaces = this.state.userSpaces;\n      if (userSpaces) {\n        userSpaces.forEach(e => {});\n        return (\n          <div className=\"profile-feed\">\n            {userSpaces.map(space => {\n              return (\n                <div key={space._id} className=\"scope-in-feed\">\n                  <Link to={`/scope/${space._id}`}>\n                    <img\n                      className=\"panorama-feed\"\n                      height=\"50px\"\n                      src={space.image}\n                    />\n                  </Link>\n                </div>\n              );\n            })}\n          </div>\n        );\n      } else {\n        return (\n          <div className=\"profile-feed\">\n          </div>\n        );\n      }\n    } else {\n      return <div />;\n    }\n  }\n}\n","import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nrequire(\"dotenv\").config();\n\nexport default class ProfileID extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      followed: false\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n    this.props.newPage();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ ...this.state, loggedInUser: nextProps[\"userInSession\"] });\n    this.getScopes();\n  }\n\n  getScopes = () => {\n    let username = this.props.match.params.username;\n    let promises = [];\n    this.service\n      .get(`auth/user/${username}`)\n      .then(user => {\n        this.setState({ userProfileID: user.data._id });\n        let isFollowing = this.checkFollowing(user.data._id);\n        let catalogId = user.data.catalog;\n        this.setState({ catalogId: catalogId, followed:isFollowing, profileUser: username });\n        return this.service.get(`/catalog/${catalogId}`);\n      })\n      .then(catalog => {\n        let spacesId = catalog.data.spaces;\n        spacesId.forEach(spaceId => {\n          promises.push(this.service.get(`/spaces/${spaceId}`));\n        });\n        return Promise.all(promises);\n      })\n      .then(promises => {\n        let spaces = [];\n        promises.forEach(prom => {\n          spaces.push(prom.data);\n        });\n        this.setState({ userSpaces: spaces });\n      })\n      .catch(error => console.log(error));\n  };\n\n  handleSubmit(e) {\n    e.preventDefault();\n    this.followUser(this.state.userProfileID);\n    this.setState({ followed: true });\n  }\n\n  checkFollowing = followedUserID => {\n    console.log(\"USER IN SESSION CHECK FOLLOWING\");\n    console.log(this.state.loggedInUser.following);\n    let currentUserFollowing = this.state.loggedInUser.following;\n    let currentUserID = this.state.loggedInUser._id;\n    console.log(currentUserID, followedUserID);\n    if (currentUserFollowing) {\n      return currentUserFollowing.includes(followedUserID);\n    } else {\n      return false;\n    }\n  };\n\n  followUser = followedUserID => {\n    let currentUserID = this.props.userInSession._id;\n    let isFollowing = this.checkFollowing(followedUserID);\n    let follow = { id: followedUserID };\n    console.log(\"FRONT \" + followedUserID);\n    if (isFollowing !== true) {\n      return this.service\n        .patch(`/auth/${currentUserID}`, follow)\n        .then(user => {\n          console.log(\"User updated on DB \" + user.data);\n        })\n        .catch(error => console.log(error));\n    }\n  };\n\n  render() {\n    let userSpaces = this.state.userSpaces;\n    let isFollowEnabled;\n    let isFollowText;\n    console.log(\"is followed \" + this.state.followed);\n    this.state.followed? isFollowEnabled=\"button is-primary is-outlined follow-button\":isFollowEnabled=\"button is-primary follow-button\";\n    this.state.followed? isFollowText=\"Unfollow\":isFollowText=\"Follow\";\n    if (userSpaces) {\n      return (\n        <div>\n          <div className=\"profile-user\">\n            <h1 className=\"profile-name\">@{this.state.profileUser}</h1>\n            <form onSubmit={e => this.handleSubmit(e)}>\n              <button className={isFollowEnabled} type=\"submit\">\n                {isFollowText}\n              </button>\n            </form>\n          </div>\n          <div className=\"profile-feed\">\n            {userSpaces.map(space => {\n              return (\n                <div key={space._id} className=\"scope-in-feed\">\n                  <Link to={`/scope/${space._id}`}>\n                    <img\n                      className=\"panorama-feed\"\n                      height=\"50px\"\n                      src={space.image}\n                    />\n                  </Link>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"profile-feed\">\n          <h1>Login to see profile</h1>\n        </div>\n      );\n    }\n  }\n}\n","/**\n * @author Eberhard Graether / http://egraether.com/\n * @author Mark Lundin \t/ http://mark-lundin.com\n * @author Simone Manini / http://daron1337.github.io\n * @author Luca Antiga \t/ http://lantiga.github.io\n */\nvar THREE = require('three');\n\nTHREE.TrackballControls = function ( object, domElement ) {\n\n\tvar _this = this;\n\tvar STATE = { NONE: - 1, ROTATE: 0, ZOOM: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_ZOOM_PAN: 4 };\n\n\tthis.object = object;\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\t// API\n\n\tthis.enabled = true;\n\n\tthis.screen = { left: 0, top: 0, width: 0, height: 0 };\n\n\tthis.rotateSpeed = 1.0;\n\tthis.zoomSpeed = 1.2;\n\tthis.panSpeed = 0.3;\n\n\tthis.noRotate = false;\n\tthis.noZoom = false;\n\tthis.noPan = false;\n\n\tthis.staticMoving = false;\n\tthis.dynamicDampingFactor = 0.2;\n\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\tthis.keys = [ 65 /*A*/, 83 /*S*/, 68 /*D*/ ];\n\n\t// internals\n\n\tthis.target = new THREE.Vector3();\n\n\tvar EPS = 0.000001;\n\n\tvar lastPosition = new THREE.Vector3();\n\n\tvar _state = STATE.NONE,\n\t\t_prevState = STATE.NONE,\n\n\t\t_eye = new THREE.Vector3(),\n\n\t\t_movePrev = new THREE.Vector2(),\n\t\t_moveCurr = new THREE.Vector2(),\n\n\t\t_lastAxis = new THREE.Vector3(),\n\t\t_lastAngle = 0,\n\n\t\t_zoomStart = new THREE.Vector2(),\n\t\t_zoomEnd = new THREE.Vector2(),\n\n\t\t_touchZoomDistanceStart = 0,\n\t\t_touchZoomDistanceEnd = 0,\n\n\t\t_panStart = new THREE.Vector2(),\n\t\t_panEnd = new THREE.Vector2();\n\n\t// for reset\n\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.up0 = this.object.up.clone();\n\n\t// events\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\n\t// methods\n\n\tthis.handleResize = function () {\n\n\t\tif ( this.domElement === document ) {\n\n\t\t\tthis.screen.left = 0;\n\t\t\tthis.screen.top = 0;\n\t\t\tthis.screen.width = window.innerWidth;\n\t\t\tthis.screen.height = window.innerHeight;\n\n\t\t} else {\n\n\t\t\tvar box = this.domElement.getBoundingClientRect();\n\t\t\t// adjustments come from similar code in the jquery offset() function\n\t\t\tvar d = this.domElement.ownerDocument.documentElement;\n\t\t\tthis.screen.left = box.left + window.pageXOffset - d.clientLeft;\n\t\t\tthis.screen.top = box.top + window.pageYOffset - d.clientTop;\n\t\t\tthis.screen.width = box.width;\n\t\t\tthis.screen.height = box.height;\n\n\t\t}\n\n\t};\n\n\tvar getMouseOnScreen = ( function () {\n\n\t\tvar vector = new THREE.Vector2();\n\n\t\treturn function getMouseOnScreen( pageX, pageY ) {\n\n\t\t\tvector.set(\n\t\t\t\t( pageX - _this.screen.left ) / _this.screen.width,\n\t\t\t\t( pageY - _this.screen.top ) / _this.screen.height\n\t\t\t);\n\n\t\t\treturn vector;\n\n\t\t};\n\n\t}() );\n\n\tvar getMouseOnCircle = ( function () {\n\n\t\tvar vector = new THREE.Vector2();\n\n\t\treturn function getMouseOnCircle( pageX, pageY ) {\n\n\t\t\tvector.set(\n\t\t\t\t( ( pageX - _this.screen.width * 0.5 - _this.screen.left ) / ( _this.screen.width * 0.5 ) ),\n\t\t\t\t( ( _this.screen.height + 2 * ( _this.screen.top - pageY ) ) / _this.screen.width ) // screen.width intentional\n\t\t\t);\n\n\t\t\treturn vector;\n\n\t\t};\n\n\t}() );\n\n\tthis.rotateCamera = ( function () {\n\n\t\tvar axis = new THREE.Vector3(),\n\t\t\tquaternion = new THREE.Quaternion(),\n\t\t\teyeDirection = new THREE.Vector3(),\n\t\t\tobjectUpDirection = new THREE.Vector3(),\n\t\t\tobjectSidewaysDirection = new THREE.Vector3(),\n\t\t\tmoveDirection = new THREE.Vector3(),\n\t\t\tangle;\n\n\t\treturn function rotateCamera() {\n\n\t\t\tmoveDirection.set( _moveCurr.x - _movePrev.x, _moveCurr.y - _movePrev.y, 0 );\n\t\t\tangle = moveDirection.length();\n\n\t\t\tif ( angle ) {\n\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\n\n\t\t\t\teyeDirection.copy( _eye ).normalize();\n\t\t\t\tobjectUpDirection.copy( _this.object.up ).normalize();\n\t\t\t\tobjectSidewaysDirection.crossVectors( objectUpDirection, eyeDirection ).normalize();\n\n\t\t\t\tobjectUpDirection.setLength( _moveCurr.y - _movePrev.y );\n\t\t\t\tobjectSidewaysDirection.setLength( _moveCurr.x - _movePrev.x );\n\n\t\t\t\tmoveDirection.copy( objectUpDirection.add( objectSidewaysDirection ) );\n\n\t\t\t\taxis.crossVectors( moveDirection, _eye ).normalize();\n\n\t\t\t\tangle *= _this.rotateSpeed;\n\t\t\t\tquaternion.setFromAxisAngle( axis, angle );\n\n\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\n\n\t\t\t\t_lastAxis.copy( axis );\n\t\t\t\t_lastAngle = angle;\n\n\t\t\t} else if ( ! _this.staticMoving && _lastAngle ) {\n\n\t\t\t\t_lastAngle *= Math.sqrt( 1.0 - _this.dynamicDampingFactor );\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\n\t\t\t\tquaternion.setFromAxisAngle( _lastAxis, _lastAngle );\n\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\n\n\t\t\t}\n\n\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t};\n\n\t}() );\n\n\n\tthis.zoomCamera = function () {\n\n\t\tvar factor;\n\n\t\tif ( _state === STATE.TOUCH_ZOOM_PAN ) {\n\n\t\t\tfactor = _touchZoomDistanceStart / _touchZoomDistanceEnd;\n\t\t\t_touchZoomDistanceStart = _touchZoomDistanceEnd;\n\t\t\t_eye.multiplyScalar( factor );\n\n\t\t} else {\n\n\t\t\tfactor = 1.0 + ( _zoomEnd.y - _zoomStart.y ) * _this.zoomSpeed;\n\n\t\t\tif ( factor !== 1.0 && factor > 0.0 ) {\n\n\t\t\t\t_eye.multiplyScalar( factor );\n\n\t\t\t}\n\n\t\t\tif ( _this.staticMoving ) {\n\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t} else {\n\n\t\t\t\t_zoomStart.y += ( _zoomEnd.y - _zoomStart.y ) * this.dynamicDampingFactor;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.panCamera = ( function () {\n\n\t\tvar mouseChange = new THREE.Vector2(),\n\t\t\tobjectUp = new THREE.Vector3(),\n\t\t\tpan = new THREE.Vector3();\n\n\t\treturn function panCamera() {\n\n\t\t\tmouseChange.copy( _panEnd ).sub( _panStart );\n\n\t\t\tif ( mouseChange.lengthSq() ) {\n\n\t\t\t\tmouseChange.multiplyScalar( _eye.length() * _this.panSpeed );\n\n\t\t\t\tpan.copy( _eye ).cross( _this.object.up ).setLength( mouseChange.x );\n\t\t\t\tpan.add( objectUp.copy( _this.object.up ).setLength( mouseChange.y ) );\n\n\t\t\t\t_this.object.position.add( pan );\n\t\t\t\t_this.target.add( pan );\n\n\t\t\t\tif ( _this.staticMoving ) {\n\n\t\t\t\t\t_panStart.copy( _panEnd );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_panStart.add( mouseChange.subVectors( _panEnd, _panStart ).multiplyScalar( _this.dynamicDampingFactor ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}() );\n\n\tthis.checkDistances = function () {\n\n\t\tif ( ! _this.noZoom || ! _this.noPan ) {\n\n\t\t\tif ( _eye.lengthSq() > _this.maxDistance * _this.maxDistance ) {\n\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.maxDistance ) );\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t}\n\n\t\t\tif ( _eye.lengthSq() < _this.minDistance * _this.minDistance ) {\n\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.minDistance ) );\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.update = function () {\n\n\t\t_eye.subVectors( _this.object.position, _this.target );\n\n\t\tif ( ! _this.noRotate ) {\n\n\t\t\t_this.rotateCamera();\n\n\t\t}\n\n\t\tif ( ! _this.noZoom ) {\n\n\t\t\t_this.zoomCamera();\n\n\t\t}\n\n\t\tif ( ! _this.noPan ) {\n\n\t\t\t_this.panCamera();\n\n\t\t}\n\n\t\t_this.object.position.addVectors( _this.target, _eye );\n\n\t\t_this.checkDistances();\n\n\t\t_this.object.lookAt( _this.target );\n\n\t\tif ( lastPosition.distanceToSquared( _this.object.position ) > EPS ) {\n\n\t\t\t_this.dispatchEvent( changeEvent );\n\n\t\t\tlastPosition.copy( _this.object.position );\n\n\t\t}\n\n\t};\n\n\tthis.reset = function () {\n\n\t\t_state = STATE.NONE;\n\t\t_prevState = STATE.NONE;\n\n\t\t_this.target.copy( _this.target0 );\n\t\t_this.object.position.copy( _this.position0 );\n\t\t_this.object.up.copy( _this.up0 );\n\n\t\t_eye.subVectors( _this.object.position, _this.target );\n\n\t\t_this.object.lookAt( _this.target );\n\n\t\t_this.dispatchEvent( changeEvent );\n\n\t\tlastPosition.copy( _this.object.position );\n\n\t};\n\n\t// listeners\n\n\tfunction keydown( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\twindow.removeEventListener( 'keydown', keydown );\n\n\t\t_prevState = _state;\n\n\t\tif ( _state !== STATE.NONE ) {\n\n\t\t\treturn;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ROTATE ] && ! _this.noRotate ) {\n\n\t\t\t_state = STATE.ROTATE;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ZOOM ] && ! _this.noZoom ) {\n\n\t\t\t_state = STATE.ZOOM;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.PAN ] && ! _this.noPan ) {\n\n\t\t\t_state = STATE.PAN;\n\n\t\t}\n\n\t}\n\n\tfunction keyup( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\t_state = _prevState;\n\n\t\twindow.addEventListener( 'keydown', keydown, false );\n\n\t}\n\n\tfunction mousedown( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( _state === STATE.NONE ) {\n\n\t\t\t_state = event.button;\n\n\t\t}\n\n\t\tif ( _state === STATE.ROTATE && ! _this.noRotate ) {\n\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t} else if ( _state === STATE.ZOOM && ! _this.noZoom ) {\n\n\t\t\t_zoomStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t_zoomEnd.copy( _zoomStart );\n\n\t\t} else if ( _state === STATE.PAN && ! _this.noPan ) {\n\n\t\t\t_panStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t_panEnd.copy( _panStart );\n\n\t\t}\n\n\t\tdocument.addEventListener( 'mousemove', mousemove, false );\n\t\tdocument.addEventListener( 'mouseup', mouseup, false );\n\n\t\t_this.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction mousemove( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( _state === STATE.ROTATE && ! _this.noRotate ) {\n\n\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\n\t\t} else if ( _state === STATE.ZOOM && ! _this.noZoom ) {\n\n\t\t\t_zoomEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t} else if ( _state === STATE.PAN && ! _this.noPan ) {\n\n\t\t\t_panEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t}\n\n\t}\n\n\tfunction mouseup( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\t_state = STATE.NONE;\n\n\t\tdocument.removeEventListener( 'mousemove', mousemove );\n\t\tdocument.removeEventListener( 'mouseup', mouseup );\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction mousewheel( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tif ( _this.noZoom === true ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.deltaMode ) {\n\n\t\t\tcase 2:\n\t\t\t\t// Zoom in pages\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.025;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\t// Zoom in lines\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.01;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// undefined, 0, assume pixels\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.00025;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( startEvent );\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction touchstart( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\t\t\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\tbreak;\n\n\t\t\tdefault: // 2 or more\n\t\t\t\t_state = STATE.TOUCH_ZOOM_PAN;\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t_touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t_panStart.copy( getMouseOnScreen( x, y ) );\n\t\t\t\t_panEnd.copy( _panStart );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction touchmove( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\tbreak;\n\n\t\t\tdefault: // 2 or more\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t_touchZoomDistanceEnd = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t_panEnd.copy( getMouseOnScreen( x, y ) );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction touchend( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 0:\n\t\t\t\t_state = STATE.NONE;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction contextmenu( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu, false );\n\t\tthis.domElement.removeEventListener( 'mousedown', mousedown, false );\n\t\tthis.domElement.removeEventListener( 'wheel', mousewheel, false );\n\n\t\tthis.domElement.removeEventListener( 'touchstart', touchstart, false );\n\t\tthis.domElement.removeEventListener( 'touchend', touchend, false );\n\t\tthis.domElement.removeEventListener( 'touchmove', touchmove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', mousemove, false );\n\t\tdocument.removeEventListener( 'mouseup', mouseup, false );\n\n\t\twindow.removeEventListener( 'keydown', keydown, false );\n\t\twindow.removeEventListener( 'keyup', keyup, false );\n\n\t};\n\n\tthis.domElement.addEventListener( 'contextmenu', contextmenu, false );\n\tthis.domElement.addEventListener( 'mousedown', mousedown, false );\n\tthis.domElement.addEventListener( 'wheel', mousewheel, false );\n\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\n\n\twindow.addEventListener( 'keydown', keydown, false );\n\twindow.addEventListener( 'keyup', keyup, false );\n\n\tthis.handleResize();\n\n\t// force an update at start\n\tthis.update();\n\n};\n\nTHREE.TrackballControls.prototype = Object.create( THREE.EventDispatcher.prototype );\nTHREE.TrackballControls.prototype.constructor = THREE.TrackballControls;\n\nexport default THREE.TrackballControls;","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport geolocalize from \"../maps/geolocalize\";\nimport * as THREE from \"three\";\nimport DeviceOrientationControls from \"../../lib/DeviceOrientationControls\";\nimport TrackballControls from \"../../lib/TrackballControls\";\nimport CSS3DRenderer from \"../../lib/CSS3DRenderer\";\nimport {CSS3elements} from \"./CSS3elements\";\nimport axios from \"axios\";\nimport { runInThisContext } from \"vm\";\nimport { UploadMediaImg } from \"../upload/UploadMediaImg\";\nimport { UploadMediaVideo } from \"../upload/UploadMediaVideo\";\nimport { UploadMediaText } from \"../upload/UploadMediaText\";\nrequire('dotenv').config();\n\n\nexport class ScopeID extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      spaceRadius: 500,\n      camera: new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1100),\n      scene: new THREE.Scene(),\n      sceneCSS: new THREE.Scene(), \n      renderer: new THREE.WebGLRenderer({ antialias: true }),\n      rendererCSS: new CSS3DRenderer(),\n      isInLocation: false,\n      isLiked: false,\n      likes: 0,\n      modal: false\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n  componentWillReceiveProps(nextProps) {\n    this.setState({ ...this.state, loggedInUser: nextProps[\"userInSession\"] });\n  }\n\n  getImage = (id) => {\n    let promises = [];\n    return this.service\n      .get(`/spaces/${id}`)\n      .then(space => {\n        console.log(space.data.likes)\n        this.setState({ image: space.data.image, mediaIDs: space.data.media, likes:space.data.likes, owner: space.data.creator });\n        this.sendNewSpace(space.data);\n      })\n      .then(()=>{\n        let mediaIDs = this.state.mediaIDs;\n        mediaIDs.forEach(mediaID => {\n          if (typeof mediaID == \"object\"){\n            mediaID = mediaID._id;\n          }\n          promises.push(this.service.get(`/media/${mediaID}`));\n        });\n        return Promise.all(promises);\n      })\n      .then(promises => {\n        let mediaArr=[];\n        promises.forEach(prom => {\n          mediaArr.push(prom.data);\n        })\n        this.setState({media: mediaArr});\n      })\n      .catch(error => console.log(error));\n  };\n\n  sendNewSpace = space => {\n    this.props.newSpace(space._id, space.location);\n    this.props.newPage();\n  }; \n\n  init = ({ camera, scene, renderer, sceneCSS, rendererCSS }) => {\n    this.setState({ controls: new DeviceOrientationControls(camera) });\n    //this.setState({ controls: new TrackballControls(camera) });\n\n    camera.position.set(0, 0, -0.001);\n\n    renderer.domElement.className = \"scope\";\n    rendererCSS.domElement.className = \"scopeCSS\";\n    \n    //Panorama Sphere\n    var geometry = new THREE.SphereBufferGeometry(this.state.spaceRadius, 60, 40);\n    geometry.scale(-1, 1, 1); // invert the geometry on the x-axis so that all of the faces point inward\n    const loader = new THREE.TextureLoader();\n    loader.crossOrigin = \"\";\n    const map = loader.load(this.state.image);\n    var material = new THREE.MeshBasicMaterial({ map });\n    var sphere = new THREE.Mesh(geometry, material);\n    scene.add(sphere);\n\n    let media = this.state.media;\n    let group;\n    let likes = this.state.likes;\n    if(media!==undefined){\n      group = CSS3elements (this.state.spaceRadius, media, likes);\n      sceneCSS.add(group);\n    }\n  \n    let scopeDiv = document.getElementById(\"scopediv\");\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    scopeDiv.appendChild(renderer.domElement);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n    scopeDiv.appendChild(rendererCSS.domElement);\n    window.addEventListener(\"resize\", this.onWindowResize, false);\n  };\n\n  animate = () => {\n    let { camera, scene, renderer, sceneCSS, rendererCSS, controls } = this.state;\n    window.requestAnimationFrame(this.animate);\n    controls.update();\n    renderer.render(scene, camera);\n    rendererCSS.render(sceneCSS, camera);\n  };\n\n  onWindowResize = () => {\n    let { camera, renderer, rendererCSS } = this.state;\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    rendererCSS.setSize(window.innerWidth, window.innerHeight);\n  };\n\n  toogleModal = (event) => { \n    if (this.state.modal){\n      this.setState({modal: false});\n      this.setState({menu: \"MEDIA\"});\n    } else{\n      this.setState({modal: true});\n      this.setState({menu: \"MEDIA\"});\n    }\n  }\n\n  mediaMenu = (event, menu)=>{\n      this.setState({menu: menu});\n  }\n\n  likeListener = () => {\n      document.body.addEventListener(\"click\", e => {\n        if(e.target.id == \"like-button\"){\n          let likes = this.state.likes + 1;\n          this.setState({likes: likes});\n          console.log(likes);\n          let space = {likes:likes, id: this.state.spaceID/* , usersWhoLiked: this.state.loggedInUser */}\n          return this.service.post(\"/spaces/like\", {space})\n          .then(space => {\n            console.log(\"Space updated on DB \" + space.data);\n          })\n          .catch(error => console.log(error));\n        }\n      });\n  }\n\n  componentDidMount = () => {\n    let id =  this.props.match.params.id;\n    this.setState({spaceID: id});\n    geolocalize().then(center => {\n      this.setState({currrentLocation: center});\n    });\n    this.getImage(id).then(() => {\n      this.init(this.state);\n      this.animate();\n    }).then(()=>{\n      this.likeListener();\n    })\n  };\n\n  render() {\n    let id =  this.props.match.params.id;\n    let likes = this.state.likes;\n\n    if (this.state.loggedInUser){\n      let isOwner = (this.state.owner == this.state.loggedInUser._id);\n\n      console.log(this.state.modal)\n      console.log(this.state.menu)\n\n      if(isOwner && !this.state.modal){\n        return (\n          <div id=\"scopediv\">\n              <button className=\"button is-white is-outlined is-rounded switch-button white\"><Link to={`/camera/${id}`}>AR</Link></button>\n              <button className=\"button is-white is-outlined is-rounded likes-button white\" onClick={ e => this.toogleModal(e)}>Add Media</button>\n          </div>\n        )\n      } \n      else if (isOwner && this.state.modal && this.state.menu == \"IMAGE\"){\n        return (\n          <div>\n            <div className=\"card box modal\">\n              <UploadMediaImg userInSession={this.state.loggedInUser} currentSpace={this.state.spaceID}/>\n            </div>\n            <div id=\"scopediv\">\n                <button className=\"button is-white is-outlined is-rounded switch-button white\"><Link to={`/camera/${id}`}>AR</Link></button>\n                <button className=\"button is-white is-outlined is-rounded likes-button white\" onClick={ e => this.toogleModal(e)}>Add Media</button>\n            </div>\n          </div>\n        )\n      } else if (isOwner && this.state.modal && this.state.menu == \"TEXT\"){\n        return (\n          <div> \n            <div className=\"card box modal\">\n              <UploadMediaText userInSession={this.state.loggedInUser} currentSpace={this.state.spaceID}/>\n            </div>\n            <div id=\"scopediv\">\n                <button className=\"button is-white is-outlined is-rounded switch-button white\"><Link to={`/camera/${id}`}>AR</Link></button>\n                <button className=\"button is-white is-outlined is-rounded likes-button white\" onClick={ e => this.toogleModal(e)}>Add Media</button>\n            </div>\n          </div>\n        )\n      } else if (isOwner && this.state.modal && this.state.menu == \"VIDEO\"){\n        return (\n          <div>\n            <div className=\"card box modal\">\n              <UploadMediaVideo userInSession={this.state.loggedInUser} currentSpace={this.state.spaceID}/>\n            </div>\n            <div id=\"scopediv\">\n                <button className=\"button is-white is-outlined is-rounded switch-button white\"><Link to={`/camera/${id}`}>AR</Link></button>\n                <button className=\"button is-white is-outlined is-rounded likes-button white\" onClick={ e => this.toogleModal(e)}>Add Media</button>\n            </div>\n          </div>\n        )\n      }\n      else if(isOwner && this.state.modal && this.state.menu == \"MEDIA\"){\n        return (\n          <div>\n            <div className=\"card box modal\">\n              <button className=\"button is-primary\" onClick={ e => this.mediaMenu(e, \"TEXT\")}>Add Text</button>\n              <button className=\"button is-primary\" onClick={ e => this.mediaMenu(e, \"IMAGE\")}>Add Image</button>\n              <button className=\"button is-primary\" onClick={ e => this.mediaMenu(e, \"VIDEO\")}>Add Video</button>\n            </div>\n            <div id=\"scopediv\">\n              <button className=\"button is-white is-outlined is-rounded likes-button white\" onClick={ e => this.toogleModal(e)}>Add Media</button>\n              <button className=\"button is-white is-outlined is-rounded switch-button white\"><Link to={`/camera/${id}`}>AR</Link></button>\n            </div>\n          </div>\n        )\n      }\n    }\n    \n    return (\n      <div>\n        <div id=\"scopediv\">\n            <button className=\"button is-white is-outlined is-rounded switch-button white\"><Link to={`/camera/${id}`}>AR</Link></button>\n            <button className=\"button is-white is-outlined is-rounded likes-button white\" disabled>{likes} likes</button>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport * as THREE from \"three\";\nimport DeviceOrientationControls from \"../../lib/DeviceOrientationControls\";\nimport TrackballControls from \"../../lib/TrackballControls\";\nimport logo from \"../../scope white.png\";\n\nvar sphere;\nexport class Welcome extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      spaceRadius: 500,\n      camera: new THREE.PerspectiveCamera(\n        75,\n        window.innerWidth / window.innerHeight,\n        1,\n        1100\n      ),\n      scene: new THREE.Scene(),\n      renderer: new THREE.WebGLRenderer({ antialias: true }),\n      modal: false\n    };\n  }\n\n  init = ({ camera, scene, renderer }) => {\n    camera.position.set(0, 0, -100); //-0.001\n\n    renderer.domElement.className = \"welcome\";\n\n    //Panorama Sphere\n    var geometry = new THREE.SphereBufferGeometry(\n      this.state.spaceRadius,\n      100,\n      40\n    );\n    geometry.scale(-1, 1, 1); // invert the geometry on the x-axis so that all of the faces point inward\n    var material = new THREE.MeshBasicMaterial({\n      color: 0xffffff,\n      wireframe: true,\n      wireframeLinewidth: 5\n    });\n    sphere = new THREE.Mesh(geometry, material);\n    scene.add(sphere);\n    scene.background = new THREE.Color(0x00d1b2);\n    let scopeDiv = document.getElementById(\"welcome\");\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    scopeDiv.appendChild(renderer.domElement);\n    window.addEventListener(\"resize\", this.onWindowResize, false);\n  };\n\n  animate = () => {\n    let { camera, scene, renderer } = this.state;\n    window.requestAnimationFrame(this.animate);\n    sphere.rotation.x += 0.0015;\n    sphere.rotation.y += 0.001;\n    sphere.rotation.z += 0.0004;\n    renderer.render(scene, camera);\n  };\n\n  onWindowResize = () => {\n    let { camera, renderer } = this.state;\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n  };\n\n  componentDidMount = () => {\n    this.props.newPage();\n    this.init(this.state);\n    this.animate();\n  };\n\n  render() {\n    return (\n      <div className=\"home\">\n        <img src={logo} className=\"logo\" />\n        <div id=\"welcome\" className=\"welcome\">\n          {/* <div className=\"card box\" id=\"welcome-card\"> */}\n\n          {/* </div>  */}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nrequire(\"dotenv\").config();\n\nexport default class Feed extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loggedInUser: props.userInSession\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ ...this.state, loggedInUser: nextProps[\"userInSession\"] });\n    this.props.newPage();\n    //this.getFeedScopes();\n  }\n\n  getFeedScopes = () => {\n    let following = this.state.loggedInUser.following;\n    let usersF = [];\n    let catalogsF = [];\n    let spacesF = [];\n    let promFollowedUsers = [];\n    let promFollowedCatalogs = [];\n    let promFollowedSpaces = [];\n    let spaceLength = [];\n    let owner=[];\n    following.forEach(followedUser => {\n      promFollowedUsers.push(this.service.get(`/auth/u/${followedUser}`));\n    });\n    return Promise.all(promFollowedUsers).then(FollowedUsers => {\n      FollowedUsers.forEach(e => {\n        usersF.push(e.data);\n      });\n      usersF.forEach(user => {\n        let catalogId = user.catalog;\n        promFollowedCatalogs.push(this.service.get(`/catalog/${catalogId}`));\n      });\n      return Promise.all(promFollowedCatalogs)\n        .then(FollowedCatalogs => {\n          FollowedCatalogs.forEach(e => {\n            catalogsF.push(e.data.spaces);\n          });\n          catalogsF.forEach(spaceArr => {\n            spaceLength.push(spaceArr.length);\n            spaceArr.forEach(space => {\n              promFollowedSpaces.push(this.service.get(`/spaces/${space}`));\n            });\n            return Promise.all(promFollowedSpaces).then(FollowedSpaces => {\n                usersF.forEach((u,j)=>{\n                    for(let i=0;i<spaceLength[j];i++){\n                        owner.push(u.username);\n                    }\n                })\n              FollowedSpaces.forEach((e,i) => {\n                let obj = { _id: e.data._id, image: e.data.image,username:owner[i] };\n                spacesF.push(obj);\n              });\n              this.setState({ feedSpaces: spacesF });\n              console.log(spaceLength)\n            });\n          });\n        })\n        .catch(error => console.log(error));\n    });\n  };\n  componentDidMount(){\n    this.getFeedScopes();\n  }\n\n  render() {\n    let feedSpaces = this.state.feedSpaces;\n\n    if (feedSpaces) {\n      return (\n        <div className=\"profile-feed\">\n          {feedSpaces.map(space => {\n            console.log(space);\n            return (\n              <div key={space._id} className=\"scope-in-feed\">\n                <p className=\"feed-user\">{space.username}</p>\n                <Link to={`/scope/${space._id}`}>\n                  <img\n                    className=\"panorama-feed\"\n                    height=\"50px\"\n                    src={space.image}\n                  />\n                </Link>\n              </div>\n            );\n          })}\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"profile-feed\">\n          <h1>Follow other users to see their Scopes</h1>\n        </div>\n      );\n    }\n  }\n}\n","import React, { Component } from 'react';\nimport * as mapConstants from './constants';\n\nexport default class Map extends Component {\n  constructor(props) {\n    super(props);\n    this.onScriptLoad = this.onScriptLoad.bind(this)\n  }\n\n  onScriptLoad() {\n    const map = new window.google.maps.Map(\n      document.getElementById(this.props.id),\n      this.props.options);\n\n      const newStyleMap = new window.google.maps.StyledMapType( mapConstants.STYLES, {name: 'MapStyled'});\n\n      map.mapTypes.set( 'MapStyled', newStyleMap );\n      map.setMapTypeId( 'MapStyled' );\n\n    this.props.onMapLoad(map)\n  }\n\n  componentDidMount() {\n    if (!window.google) {\n      var s = document.createElement('script');\n      s.type = 'text/javascript';\n      s.src = `https://maps.google.com/maps/api/js?key=AIzaSyA2VCIDASPyZRdr58uKR5ucueARsagOD6s`;\n      var x = document.getElementsByTagName('script')[0];\n      x.parentNode.insertBefore(s, x);\n      // Below is important. \n      //We cannot access google.maps until it's finished loading\n      s.addEventListener('load', e => {\n        this.onScriptLoad()\n      })\n    } else {\n      this.onScriptLoad()\n    }\n  }\n\n  render() {\n    return (\n      <div style={{ width: window.innerWidth, height: window.innerHeight }} id={this.props.id} />\n    );\n  }\n}","import React, { Component } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nimport geolocalize from \"./maps/geolocalize\";\nimport Map from \"./maps/Map\";\n\nexport class ExploreMap extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      redirect: false\n    };\n    this.service = axios.create({\n      baseURL: `${process.env.REACT_APP_API_URL}/api`\n    });\n    geolocalize().then(center => {\n      console.log(center);\n      this.setState({ location: center });\n    });\n  }\n\n  setRedirect = marker => {\n    this.setState({\n      redirect: true,\n      url: marker\n    });\n  };\n\n  getMarkers = () => {\n    this.service.get(\"/spaces\").then(spaces => {\n      this.setState({ spaces: spaces.data });\n    });\n  };\n\n  renderRedirect = () => {\n    if (this.state.redirect) {\n      console.log(this.state.url);\n      let url = `/scope/${this.state.url}`;\n      return <Redirect to={url} />;\n    }\n  };\n\n  componentWillMount() {\n    this.getMarkers();\n    this.props.newPage();\n  }\n\n  render() {\n    let spaces = this.state.spaces;\n\n    if (spaces) {\n      return (\n        <div>\n          {this.renderRedirect()}\n          <Map\n            id=\"myMap\"\n            options={{ center: this.state.location, zoom: 12 }}\n            onMapLoad={map => {\n              let markers = [];\n              if (spaces) {\n                spaces.forEach(space => {\n                  let marker = new window.google.maps.Marker({\n                    position: space.location,\n                    map: map,\n                    icon: \"./marker.png\",\n                    url: space._id,\n                    title: \"Scope near you!\"\n                  });\n                  markers.push(marker);\n                });\n              }\n              markers.forEach(marker => {\n                marker.addListener(\"click\", e => {\n                  this.setRedirect(marker.url);\n                  console.log(marker.url);\n                });\n              });\n            }}\n          />\n        </div>\n      );\n    } else {\n      return <div/>\n    }\n  }\n}\n","import React, { Component } from \"react\";\nimport { Switch, Route } from 'react-router-dom';\nimport { CSSTransition, TransitionGroup } from \"react-transition-group\";\n\nimport \"./App.scss\";\n\nimport Navbar from './components/Navbar';\nimport AuthService from \"./components/auth/AuthService\";\nimport Signup from './components/auth/Signup';\nimport Login from './components/auth/Login';\n\nimport { ScopeView } from \"./components/ScopeView\";\nimport { UploadSpace } from \"./components/upload/UploadSpace\";\nimport { UploadMediaImg} from \"./components/upload/UploadMediaImg\";\nimport { ScopeCamera } from \"./components/3dSpace/ScopeCamera\";\nimport { ScopeCameraID } from \"./components/3dSpace/ScopeCameraID\";\nimport { UploadMediaVideo } from \"./components/upload/UploadMediaVideo\";\nimport { UploadMediaText } from \"./components/upload/UploadMediaText\";\nimport BottomMenu from \"./components/BottomMenu\";\nimport Profile from \"./components/Profile\";\nimport ProfileID from \"./components/ProfileID\";\nimport { ScopeID } from \"./components/3dSpace/ScopeID\";\nimport { Welcome } from \"./components/3dSpace/Welcome\";\nimport Feed from \"./components/Feed\";\nimport { ExploreMap } from \"./components/ExploreMap\";\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      loggedInUser: null,\n      spaceId: \"5bc3313fdd315804e045a573\",\n      spaceLocation: {lat: 40.3923451, lng: -3.6985332999999994},\n      page: \"Home\"\n    };\n    this.service = new AuthService();\n  }\n\n  getTheUser = userObj => {\n    this.setState({\n      loggedInUser: userObj\n    });\n  };\n\n  logout = () => {\n    this.service.logout().then(() => {\n      this.setState({ loggedInUser: null });\n    });\n  };\n\n  fetchUser() {\n    if (this.state.loggedInUser === null) {\n      this.service\n        .loggedin()\n        .then(response => {\n          this.setState({\n            loggedInUser: response\n          });\n        })\n        .catch(err => {\n          this.setState({\n            loggedInUser: false\n          });\n        });\n    }\n  }\n\n  actualizeSpace = (space, location) => {\n    this.setState({ spaceId: space, spaceLocation: location });\n  };\n\n  render() {\n    console.log(\"SPACE ID STATE APP\")\n    console.log(this.state.spaceId)\n    this.fetchUser();\n    return (\n      <div className=\"App\">\n        <header className=\"header\">\n          <Navbar userInSession={this.state.loggedInUser} page ={this.state.page} logout={this.logout} page= {this.state.page}/>\n        </header>\n        <div className=\"fix-top\"></div>\n        <main>\n          <Switch>\n            <Route exact path='/' render={() => <Welcome newPage={()=>{this.setState({page:\"Home\"})}}/> }/>  \n            <Route exact path='/feed' render={(props) => <Feed userInSession={this.state.loggedInUser} newPage={()=>{this.setState({page:\"Feed\"})}} {...props}/>}/>\n            <Route exact path='/explore' render={(props) => <ExploreMap location={this.state.spaceLocation} {...props} newPage={()=>{this.setState({page:\"Explore\"})}}/>}/>\n            <Route exact path='/signup' render={() => <Signup getUser={this.getTheUser} newPage={()=>{this.setState({page:\"Home\"})}}/>}/>\n            <Route exact path='/login' render={() => <Login getUser={this.getTheUser} newPage={()=>{this.setState({page:\"Home\"})}}/>}/>\n            <Route path='/profile/:username' render={(props) => <ProfileID userInSession={this.state.loggedInUser} newPage={()=>{this.setState({page:\"ProfileID\"})}} {...props}/>}/>\n            <Route exact path='/profile' render={() => <Profile userInSession={this.state.loggedInUser} newPage={()=>{this.setState({page:\"Profile\"})}}/>}/>\n            <Route path='/scope/:id' render={(props) => <ScopeID  userInSession={this.state.loggedInUser} newPage={()=>{this.setState({page:\"Scope\"})}} newSpace={(space, location) => {this.actualizeSpace(space, location)}} {...props}/>}/>\n            <Route exact path='/camera/:id' render={(props) => <ScopeCameraID newPage={()=>{this.setState({page:\"Scope\"})}} newSpace={(space, location) => {this.actualizeSpace(space, location)}} {...props}/>}/>\n            <Route exact path='/upload-scope' render={() => <UploadSpace newPage={()=>{this.setState({page:\"Upload\"})}} newSpace={(space, location) => {this.actualizeSpace(space, location)}} userInSession={this.state.loggedInUser}/>}/>\n          </Switch>\n        </main>\n        <div className=\"fix-bottom\"></div>\n        <footer>\n            <BottomMenu userInSession={this.state.loggedInUser} page= {this.state.page}/>\n        </footer>\n      </div>\n    );\n  }\n}\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n\n              // Execute callback\n              if (config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport \"bulma/css/bulma.css\";\nimport './index.scss';\nimport App from './App';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<Router><App /></Router>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}